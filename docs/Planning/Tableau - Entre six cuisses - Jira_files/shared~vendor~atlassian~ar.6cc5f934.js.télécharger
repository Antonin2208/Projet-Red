try{window.performance.mark("shared~vendor~atlassian~ar.js:eval-start")}catch(e){}function e(e,t,s,r){Object.defineProperty(e,t,{get:s,set:r,enumerable:!0,configurable:!0})}function t(e){return e&&e.__esModule?e.default:e}var s=globalThis,r={},i={},a=s.parcelRequire94c2;null==a&&(a=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var s={id:e,exports:{}};return r[e]=s,t.call(s.exports,s,s.exports),s.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a},a.register=function(e,t){i[e]=t},s.parcelRequire94c2=a);var n=a.register;s.lb||(s.lb=new Set,s.bq=[],s.rlb=e=>{s.lb.add(e),s.pq()},s.rwr=(e,t,r)=>{s.bq.push({b:e,r:t,d:r}),s.pq()},s.pq=()=>{var e=s.bq.find(e=>e.d.every(e=>s.lb.has(e)));e&&(s.bq=s.bq.filter(t=>t.b!==e.b),e.r(),s.pq())}),n("b2t3Q",function(t,s){function r(e){(0,a("dionJ").setBooleanResolver)(e)}function i(e){return(0,a("dionJ").resolveBooleanFlag)(e)}function n(e){return(0,a("dionJ").resolveBooleanFlag)(e)}e(t.exports,"setBooleanFeatureFlagResolver",()=>r),e(t.exports,"getBooleanFF",()=>i),e(t.exports,"fg",()=>n)}),n("dionJ",function(t,s){e(t.exports,"setBooleanResolver",()=>u),e(t.exports,"resolveBooleanFlag",()=>d);var r=a("2fFJv");let i="__PLATFORM_FEATURE_FLAGS__",n=void 0!==r&&void 0!==r.env,o=!n&&!1,l={earlyResolvedFlags:new Map,booleanResolver:function(e){return!1}},c="undefined"!=typeof window?window:globalThis;function u(e){c[i].booleanResolver=e}function d(e){if(o)return(0,a("bWW4s").debug)('[%s]: The feature flags were enabled while running tests. The flag "%s" will be always enabled.',"@atlaskit/platform-feature-flags",e),!0;try{let t=c[i]?.booleanResolver(e);if("boolean"!=typeof t)return console.warn(`${e} resolved to a non-boolean value, returning false for safety`),!1;return t}catch(e){return!1}}c[i]=c[i]||l}),n("bWW4s",function(t,s){e(t.exports,"debug",()=>a);let r=globalThis?.process?.env?.JEST_WORKER_ID!==void 0,i=!r&&globalThis?.process?.env?.NODE_ENV!=="production",a=(...e)=>{i&&console.debug(...e)}}),n("dtY0Y",function(t,s){e(t.exports,"default",()=>r);var r=(0,a("eUqFw").createContext)(null)}),n("kUpy5",function(t,s){e(t.exports,"isFedRamp",()=>r);function r(){let e=globalThis,t=e.MICROS_PERIMETER||e.UNSAFE_ATL_CONTEXT_BOUNDARY;if(t)return t===o;let s=e.location?.hostname?.match(/atlassian-us-gov-mod\.(com|net)|atlassian-us-gov\.(com|net)|atlassian-fex\.(com|net)|atlassian-stg-fedm\.(com|net)/);return!!s&&s.length>0}});const o="fedramp-moderate";n("lGWSE",function(s,r){e(s.exports,"default",()=>c),e(s.exports,"DynamicConfig",()=>a("avKkz").DynamicConfig),e(s.exports,"EvaluationReason",()=>a("avKkz").EvaluationReason),e(s.exports,"FeatureGateEnvironment",()=>a("2KLYM").FeatureGateEnvironment),e(s.exports,"PerimeterType",()=>a("2KLYM").PerimeterType);var i=a("avKkz");let n="client-default-key";class o{static{this.initPromise=null}static{this.initCompleted=!1}static{this.hasGetExperimentErrorOccurred=!1}static{this.hasGetExperimentValueErrorOccurred=!1}static{this.hasGetLayerErrorOccurred=!1}static{this.hasGetLayerValueErrorOccurred=!1}static{this.hasCheckGateErrorOccurred=!1}static async initialize(e,t,s){if(o.initPromise)return o.shallowEquals(e,o.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied."),o.initPromise;let r=performance.now();return o.initOptions=e,o.initPromise=o.init(e,t,s).then(()=>{o.initCompleted=!0}).finally(()=>{let t=performance.now(),s=t-r;o.fireClientEvent(r,s,"initialize",o.initCompleted,e.apiKey)}),o.initPromise}static fireClientEvent(e,t,s,r,i){o.initOptions.analyticsWebClient?.then(n=>{let l={targetApp:o.initOptions.targetApp,clientVersion:a("5MwkL").CLIENT_VERSION,success:r,startTime:e,totalTime:t,...i&&{apiKey:i}};n.sendOperationalEvent({action:s,actionSubject:"featureGatesClient",attributes:l,tags:["measurement"],source:"@atlaskit/feature-gate-js-client"})}).catch(e=>{o.initOptions.environment!==a("2KLYM").FeatureGateEnvironment.Production&&console.error("Analytics web client promise did not resolve",e)})}static async initializeFromValues(e,t,s,r={}){if(o.initPromise)return o.shallowEquals(e,o.initOptions)||console.warn("Feature Gates client already initialized with different options. New options were not applied."),o.initPromise;let i=performance.now();return o.initOptions=e,o.initPromise=o.initFromValues(e,t,s,r).then(()=>{o.initCompleted=!0}).finally(()=>{let e=performance.now(),t=e-i;o.fireClientEvent(i,t,"initializeFromValues",o.initCompleted)}),o.initPromise}static async updateUser(e,t,s){await o.updateUserUsingInitializeValuesProducer(()=>(0,a("jWiWl").default).fetchExperimentValues(e,t,s).then(({experimentValues:e,customAttributes:t})=>({experimentValues:e,customAttributesFromFetch:t})),t,s)}static async updateUserWithValues(e,t,s={}){await o.updateUserUsingInitializeValuesProducer(()=>Promise.resolve({experimentValues:s,customAttributesFromFetch:t}),e,t)}static initializeCalled(){return null!=o.initPromise}static initializeCompleted(){return o.initCompleted}static checkGate(e,s={}){try{let{fireGateExposure:r=!0}=s,a=r?t(i).checkGate.bind(t(i)):t(i).checkGateWithExposureLoggingDisabled.bind(t(i));return a(e)}catch(t){return o.hasCheckGateErrorOccurred||(console.warn({msg:"An error has occurred checking the feature gate. Only the first occurrence of this error is logged.",gateName:e,error:t}),o.hasCheckGateErrorOccurred=!0),!1}}static manuallyLogGateExposure(e){t(i).manuallyLogGateExposure(e)}static getExperiment(e,s={}){try{let{fireExperimentExposure:r=!0}=s,a=r?t(i).getExperiment.bind(t(i)):t(i).getExperimentWithExposureLoggingDisabled.bind(t(i));return a(e)}catch(t){return o.hasGetExperimentErrorOccurred||(console.warn({msg:"An error has occurred getting the experiment. Only the first occurrence of this error is logged.",experimentName:e,error:t}),o.hasGetExperimentErrorOccurred=!0),new i.DynamicConfig(e,{},"",{time:Date.now(),reason:i.EvaluationReason.Error})}}static getExperimentValue(e,t,s,r={}){let i=o.getExperiment(e,r);try{let{typeGuard:e}=r;return i.get(t,s,e)}catch(t){return o.hasGetExperimentValueErrorOccurred||(console.warn({msg:"An error has occurred getting the experiment value. Only the first occurrence of this error is logged.",experimentName:e,defaultValue:s,options:r,error:t}),o.hasGetExperimentValueErrorOccurred=!0),s}}static manuallyLogExperimentExposure(e){t(i).manuallyLogExperimentExposure(e)}static manuallyLogLayerExposure(e,s){t(i).manuallyLogLayerParameterExposure(e,s)}static shutdownStatsig(){t(i).shutdown()}static overrideGate(e,s){t(i).overrideGate(e,s)}static clearGateOverride(e){t(i).overrideGate(e,null)}static overrideConfig(e,s){t(i).overrideConfig(e,s)}static clearConfigOverride(e){t(i).overrideConfig(e,null)}static setOverrides(e){t(i).setOverrides({gates:{},configs:{},layers:{},...e})}static getOverrides(){return t(i).getOverrides()}static clearAllOverrides(){t(i).setOverrides(null)}static isCurrentUser(e,t){return o.shallowEquals(o.currentIdentifiers,e)&&o.shallowEquals(o.currentAttributes,t)}static async init(e,t,s){let r,i;let n={...e,disableCurrentPageLogging:!0};try{let o=(0,a("jWiWl").default).fetchClientSdk(e).then(e=>n.sdkKey=e.clientSdkKey),l=(0,a("jWiWl").default).fetchExperimentValues(e,t,s),[,c]=await Promise.all([o,l]);r=c.experimentValues,i=c.customAttributes}catch(e){throw e instanceof Error&&console.error(`Error occurred when trying to fetch the Feature Gates client values, error: ${e?.message}`),console.warn("Initialising Statsig client without values"),await o.initFromValues(n,t,s),e}await this.initFromValues(n,t,i,r)}static async initFromValues(e,s,r,l={}){let c=this.toStatsigUser(s,r);o.currentIdentifiers=s,o.currentAttributes=r,e.sdkKey||(e.sdkKey=n),e.eventLoggingApi||(e.eventLoggingApi="https://xp.atlassian.com/v1/"),e.perimeter===a("2KLYM").PerimeterType.FEDRAMP_MODERATE&&(e.disableAllLogging=!0);let{sdkKey:u}=e,d=this.toStatsigOptions(e,l);try{await t(i).initialize(u,c,d)}catch(e){throw e instanceof Error&&console.error(`Error occurred when trying to initialise the Statsig client, error: ${e?.message}`),console.warn("Initialising Statsig client with default sdk key and without values"),await t(i).initialize(n,c,{...d,initializeValues:{}}),e}}static toStatsigUser(e,t){let s={customIDs:e,custom:t};return e.atlassianAccountId&&(s.userID=e.atlassianAccountId),s}static async updateUserUsingInitializeValuesProducer(e,t,s){if(!o.initPromise)throw Error("The FeatureGates client must be initialized before you can update the user.");if(o.isCurrentUser(t,s))return o.initPromise;let r=o.initPromise;try{await o.initPromise}catch(e){}let i=e(),a=o.updateStatsigClientUser(i,t,s);return o.initPromise=a.catch(()=>{o.initPromise=r}),a}static async updateStatsigClientUser(e,s,r){let a,n;try{a=await e,n=o.toStatsigUser(s,a.customAttributesFromFetch)}catch(t){let e=t instanceof Error?t.message:JSON.stringify(t);throw o.initOptions.updateUserCompletionCallback?.(!1,e),t}let l=t(i).updateUserWithValues(n,a.experimentValues);if(l)o.currentIdentifiers=s,o.currentAttributes=r;else throw Error("Failed to update user. An unexpected error occured.")}static toStatsigOptions(e,t){let{sdkKey:s,updateUserCompletionCallback:r,perimeter:i,...a}=e;return{...a,initializeValues:t,environment:{tier:e.environment},disableCurrentPageLogging:!0,...e.updateUserCompletionCallback&&{updateUserCompletionCallback:o.toStatsigUpdateUserCompletionCallback(e.updateUserCompletionCallback)}}}static toStatsigUpdateUserCompletionCallback(e){return(t,s,r)=>{e(s,r)}}static shallowEquals(e,t){if(!e&&!t)return!0;if(!e||!t)return!1;let s=Object.entries(e),r=Object.entries(t);if(s.length!==r.length)return!1;let i=([e],[t])=>e.localeCompare(t);s.sort(i),r.sort(i);for(let e=0;e<s.length;e++){let[,t]=s[e],[,i]=r[e];if(t!==i)return!1}return!0}static getPackageVersion(){return a("5MwkL").CLIENT_VERSION}static getLayer(e,s={}){try{let{fireLayerExposure:r=!0}=s,a=r?t(i).getLayer.bind(t(i)):t(i).getLayerWithExposureLoggingDisabled.bind(t(i));return a(e)}catch(t){return o.hasGetLayerErrorOccurred||(console.warn({msg:"An error has occurred getting the layer. Only the first occurrence of this error is logged.",layerName:e,error:t}),o.hasGetLayerErrorOccurred=!0),(0,i.Layer)._create(e,{},"",{time:Date.now(),reason:i.EvaluationReason.Error})}}static getLayerValue(e,t,s,r={}){let i=o.getLayer(e,r);try{let{typeGuard:e}=r;return i.get(t,s,e)}catch(t){return o.hasGetLayerValueErrorOccurred||(console.warn({msg:"An error has occurred getting the layer value. Only the first occurrence of this error is logged.",layerName:e,defaultValue:s,options:r,error:t}),o.hasGetLayerValueErrorOccurred=!0),s}}}let l=o;if("undefined"!=typeof window){if(void 0===window.__FEATUREGATES_JS__)window.__FEATUREGATES_JS__=o;else{l=window.__FEATUREGATES_JS__;let e=l?.getPackageVersion?.()||"4.10.0 or earlier";if(e!==a("5MwkL").CLIENT_VERSION){let t=`Multiple versions of FeatureGateClients found on the current page.
      The currently bound version is ${e} when module version ${a("5MwkL").CLIENT_VERSION} was loading.`;console.warn(t)}}}var c=l}),n("jWiWl",function(t,s){e(t.exports,"default",()=>r);class r{static async fetchClientSdk(e){let{targetApp:t}=e,s=`/api/v2/frontend/clientSdkKey/${t}`;try{return await this.fetchRequest(s,"GET",e)}catch(e){if(e instanceof Error)throw e;throw Error("Failed to retrieve client sdk key")}}static async fetchExperimentValues(e,t,s){let r={identifiers:t,customAttributes:s,targetApp:e.targetApp};try{return await this.fetchRequest("/api/v2/frontend/experimentValues","POST",e,r)}catch(e){if(e instanceof Error)throw e;throw Error("Failed to retrieve experiment values")}}static async handleResponseError(e){if(!e.ok){let t=await e.text();throw new(a("4lxDF")).ResponseError(`Non 2xx response status received, status: ${e.status}, body: ${JSON.stringify(t)}`)}if(204===e.status)throw new(a("4lxDF")).ResponseError("Unexpected 204 response")}static async extractResponseBody(e){let t=await e.text();return JSON.parse(t)}static getBaseUrl(e,t=!1,s=a("2KLYM").PerimeterType.COMMERCIAL){if(t)return"/gateway/api/flags";if(s===a("2KLYM").PerimeterType.FEDRAMP_MODERATE)switch(e){case a("2KLYM").FeatureGateEnvironment.Production:return"https://api.atlassian-us-gov-mod.com/flags";case a("2KLYM").FeatureGateEnvironment.Staging:return"https://api.stg.atlassian-us-gov-mod.com/flags";default:throw Error(`Invalid environment "${e}" for "${s}" perimeter`)}else if(s===a("2KLYM").PerimeterType.COMMERCIAL)switch(e){case a("2KLYM").FeatureGateEnvironment.Development:return"https://api.dev.atlassian.com/flags";case a("2KLYM").FeatureGateEnvironment.Staging:return"https://api.stg.atlassian.com/flags";default:return"https://api.atlassian.com/flags"}else throw Error(`Invalid perimeter "${s}"`)}static async fetchRequest(e,t,s,i){let n;let o=r.getBaseUrl(s.environment,s.useGatewayURL,s.perimeter),l=s.fetchTimeoutMs||5e3;if(AbortSignal.timeout)n=AbortSignal.timeout(l);else if(AbortController){let e=new AbortController;n=e.signal,setTimeout(()=>e.abort(),l)}let c=await fetch(`${o}${e}`,{method:t,headers:{"Content-Type":"application/json","X-Client-Name":"feature-gate-js-client","X-Client-Version":a("5MwkL").CLIENT_VERSION,"X-API-KEY":s.apiKey},signal:n,...i&&{body:JSON.stringify(i)}});return await this.handleResponseError(c),await this.extractResponseBody(c)}}}),n("2KLYM",function(t,s){var r,i,a,n;e(t.exports,"FeatureGateEnvironment",()=>r),e(t.exports,"PerimeterType",()=>i),(a=r||(r={})).Development="development",a.Staging="staging",a.Production="production",(n=i||(i={})).COMMERCIAL="commercial",n.FEDRAMP_MODERATE="fedramp-moderate"}),n("5MwkL",function(t,s){e(t.exports,"CLIENT_VERSION",()=>r);let r="0.0.0-use.local"}),n("4lxDF",function(t,s){e(t.exports,"ResponseError",()=>r);class r extends Error{constructor(e){super(e)}}}),n("g7gUT",function(t,s){e(t.exports,"allFeatureFlagsAccessed",()=>r),e(t.exports,"currentFeatureFlagsAccessed",()=>i),e(t.exports,"addFeatureFlagAccessed",()=>n);let r=new Map,i=new Map,n=(e,t)=>{try{globalThis.__CRITERION__&&"function"==typeof globalThis.__CRITERION__.addFeatureFlagAccessed&&globalThis.__CRITERION__.addFeatureFlagAccessed(e,t)}catch(e){}let s=(0,a("2p7kX").redactValue)(t);r.set(e,s),i.set(e,s)}}),n("2p7kX",function(t,s){e(t.exports,"redactValue",()=>o);let r=e=>{try{if("{"===e.charAt(0))return!0}catch(e){}return!1},i=e=>e&&"object"==typeof e&&e.constructor===Object,a=e=>{let t;try{t="string"==typeof e||e instanceof String}catch(e){t=!1}return t},n=e=>a(e)&&r(e)||i(e),o=e=>n(e)?l:e});const l="non_boolean";n("4SW9h",function(t,s){e(t.exports,"default",()=>a("hli96").default),a("hli96"),a("3aUFH")}),n("hli96",function(t,s){e(t.exports,"default",()=>l);var r=a("3aUFH"),i=a("l9y3b"),n=a("1vl0o"),o=a("2VDyi");class l{constructor(e){(0,i.enforceAttributes)(e,["analyticsHandler"],"Feature Flag Client");let{flags:t,analyticsHandler:s,isAutomaticExposuresEnabled:r,ignoreTypes:a}=e;this.flags=new Map,this.flagWrapperCache=new Map,this.customAttributesExposuresCache=new Set,this.trackedFlags=new Set,this.isAutomaticExposuresEnabled=r||!1,this.ignoreTypes=a||!1,this.setFlags(t||{}),this.setAnalyticsHandler(s)}setFlags(e){if((0,i.isObject)(e))for(let t of(Object.entries(e).forEach(([e,t])=>{this.flags.set(e,t)}),this.flagWrapperCache.keys()))e.hasOwnProperty(t)&&this.flagWrapperCache.delete(t)}setAnalyticsHandler(e){this.analyticsHandler=e}setIsAutomaticExposuresEnabled(e){this.isAutomaticExposuresEnabled=e}getFlagWrapper(e){let t=this.flagWrapperCache.get(e);if(void 0!==t)return t;let s=this.flags.get(e);return t=s?new o.default(e,s,this._trackExposure.bind(this),this.sendAutomaticExposure.bind(this),this.ignoreTypes):new n.default,this.flagWrapperCache.set(e,t),t}clear(){this.flags.clear(),this.flagWrapperCache.clear(),this.trackedFlags.clear()}getBooleanValue(e,t){(0,i.enforceAttributes)(t,["default"],"getBooleanValue");let s=this.getFlagWrapper(e);return s.getBooleanValue(t)}getVariantValue(e,t){(0,i.enforceAttributes)(t,["default","oneOf"],"getVariantValue");let s=this.getFlagWrapper(e);return s.getVariantValue(t)}getJSONValue(e){let t=this.getFlagWrapper(e);return t.getJSONValue()}getRawValue(e,t){(0,i.enforceAttributes)(t,["default"],"getRawValue");let s=this.getFlagWrapper(e);return s.getRawValue(t)}getFlagEvaluation(e,t){(0,i.enforceAttributes)(t,["default"],"getRawValue");let s=this.getFlagWrapper(e);return s.getFlagEvaluation(t)}trackFeatureFlag(e,t={}){let s=t?.triggerReason?t.triggerReason:r.ExposureTriggerReason.Manual,i=this.flags.has(e)||"value"in t;if(!i){console.warn(`No value associated with the flagKey: ${e} with an exposure trigger reason of: ${s}`);return}let a="value"in t?t.value:this.flags.get(e)?.value,n=t?.explanation?t.explanation:this.flags.get(e)?.explanation;s===r.ExposureTriggerReason.AutoExposure?this.sendAutomaticExposure(e,a,n):this._trackExposure(e,{value:a,explanation:n},s)}trackExposure(e,t,s={}){return this._trackExposure(e,t,r.ExposureTriggerReason.Manual,s)}_trackExposure(e,t,s,r){if(!(t&&t.explanation&&this.shouldSendEvent(e,r)))return;(0,i.checkForReservedAttributes)(r);let a={flagKey:e,reason:t.explanation.kind,ruleId:t.explanation.ruleId,value:t.value};this.sendExposureEvent(a,s,r)}shouldSendEvent(e,t){return void 0!==this.analyticsHandler&&(!this.trackedFlags.has(e)||!(0,i.isObjectEmptyOrUndefined)(t)&&!this.customAttributesExposuresCache.has(e))}sendAutomaticExposure(e,t,s){if(!(s&&this.isAutomaticExposuresEnabled&&this.shouldSendEvent(e)))return;let i={flagKey:e,value:t,reason:s.kind||"SIMPLE_EVAL",ruleId:s.ruleId,errorKind:s.errorKind};this.sendExposureEvent(i,r.ExposureTriggerReason.AutoExposure)}sendExposureEvent(e,t,s){if(this.trackedFlags.has(e.flagKey)||(this.analyticsHandler?.sendOperationalEvent({action:"exposed",actionSubject:"feature",attributes:e,tags:["measurement",t],highPriority:!1,source:"@atlaskit/feature-flag-client"}),this.trackedFlags.add(e.flagKey)),!(0,i.isObjectEmptyOrUndefined)(s)){let i={action:"exposed",actionSubject:"feature",attributes:Object.assign({},e,s),tags:["measurement",r.ExposureTriggerReason.hasCustomAttributes,t],highPriority:!0,source:"@atlaskit/feature-flag-client"};this.analyticsHandler?.sendOperationalEvent(i),this.customAttributesExposuresCache.add(e.flagKey)}}getFlagStats(){let e={};for(let[t,s]of this.flagWrapperCache){let{evaluationCount:r}=s;e[t]={evaluationCount:r}}return e}}}),n("3aUFH",function(t,s){var r,i;e(t.exports,"ExposureTriggerReason",()=>r),(i=r||(r={})).OptIn="optInExposure",i.Manual="manualExposure",i.Default="defaultExposure",i.AutoExposure="autoExposure",i.hasCustomAttributes="hasCustomAttributes"}),n("l9y3b",function(t,s){e(t.exports,"isObject",()=>r),e(t.exports,"isObjectEmptyOrUndefined",()=>i),e(t.exports,"enforceAttributes",()=>a),e(t.exports,"checkForReservedAttributes",()=>n);let r=e=>"object"==typeof e,i=e=>!e||0===Object.keys(e).length,a=(e,t,s)=>{t.forEach(t=>{if(!(t in e)){let e=s?`${s}: `:"";throw Error(`${e}Missing ${t}`)}})},n=e=>{let t=["flagKey","ruleId","reason","value","errorKind"],s=e?Object.keys(e):[];if(t.some(e=>s.includes(e)))throw TypeError(`exposureData contains a reserved attribute. Reserved attributes are: ${t.join(", ")}`)}}),n("1vl0o",function(t,s){e(t.exports,"default",()=>i);let r={kind:"ERROR",errorKind:"FLAG_NOT_FOUND"};class i{evaluate(e){return e}getBooleanValue(e){return this.evaluate(e.default)}getVariantValue(e){return this.evaluate(e.default)}getJSONValue(){return this.evaluate({})}getRawValue(e){return this.evaluate(e.default)}getFlagEvaluation(e){let t=this.evaluate(e.default);return{value:t,explanation:r}}constructor(){this.evaluationCount=-1}}}),n("2VDyi",function(t,s){e(t.exports,"default",()=>i);var r=a("3aUFH");class i{constructor(e,t,s,r,i){this.flagKey=e,this.flag=t,this.evaluationCount=0,this.trackExposure=s,this.sendAutomaticExposure=r,this.ignoreTypes=i}getCachedResultOrCompute(e,{shouldTrackExposureEvent:t,exposureData:s,oneOf:i,ignoreTypes:a}){let n=r.ExposureTriggerReason.OptIn;void 0===t&&(t=!0,n=r.ExposureTriggerReason.Default),void 0===this.evaluationResult&&(this.evaluationResult=this.computeWithValidation(e,{oneOf:i,ignoreTypes:a}));let o=this.evaluationResult.value;return this.evaluationResult.didFallbackToDefaultValue?o=e:t&&this.trackExposure(this.flagKey,this.flag,n,s),this.sendAutomaticExposure(this.flagKey,o,this.evaluationResult.explanation),this.evaluationCount++,{value:o,explanation:this.evaluationResult.explanation}}computeWithValidation(e,{oneOf:t,ignoreTypes:s}){let r={value:this.flag.value,explanation:this.flag.explanation,didFallbackToDefaultValue:!1};return s||typeof this.flag.value==typeof e?void 0===t||t.includes(this.flag.value)||(r.value=e,r.didFallbackToDefaultValue=!0,r.explanation={...r.explanation||{},kind:"ERROR",errorKind:"VALIDATION_ERROR"}):(r.value=e,r.didFallbackToDefaultValue=!0,r.explanation={...r.explanation||{},kind:"ERROR",errorKind:"WRONG_TYPE"}),r}getBooleanValue(e){let t=this.getCachedResultOrCompute(e.default,{exposureData:e.exposureData,shouldTrackExposureEvent:e.shouldTrackExposureEvent,oneOf:void 0,ignoreTypes:this.ignoreTypes||!1});return t.value}getVariantValue(e){let t=this.getCachedResultOrCompute(e.default,{exposureData:e.exposureData,shouldTrackExposureEvent:e.shouldTrackExposureEvent,oneOf:e.oneOf,ignoreTypes:this.ignoreTypes||!1});return t.value}getJSONValue(){return this.getCachedResultOrCompute({},{shouldTrackExposureEvent:!1,ignoreTypes:this.ignoreTypes}).value}getRawValue(e){return this.getCachedResultOrCompute(e.default,{shouldTrackExposureEvent:e.shouldTrackExposureEvent,exposureData:e.exposureData,oneOf:void 0,ignoreTypes:!0}).value}getFlagEvaluation(e){return this.getCachedResultOrCompute(e.default,{shouldTrackExposureEvent:e.shouldTrackExposureEvent,exposureData:e.exposureData,ignoreTypes:this.ignoreTypes||!1})}}}),n("420b1",function(s,r){e(s.exports,"default",()=>l);var i=a("dFBS3");let n="atlOrigin",o={originLibrary:"origin-tracing.js@0.0.0-use.local"};class l{constructor({id:e=l.generateId(),product:t,dangerouslySkipValidation:s=!1}){this.id=e,this.product=t,s||this.validate()}static isValidId(e){return"string"==typeof e&&/^[-_a-zA-Z0-9]{1,36}$/.test(e)}static isValidProduct(e){return"string"==typeof e&&/^[-_a-zA-Z0-9]{1,20}$/.test(e)}static generateId(){let e=t(i)();return e.replace(/-/g,"")}static createEmpty(){return new c}static createMalformed(){return new u}static fromUrl(e){let t=new((0,a("dVSJk").getEnv)()).URLSearchParams;return d(e,e=>{t=new((0,a("dVSJk").getEnv)()).URLSearchParams(e)}),l.fromEncoded(t.get(n))}static fromEncoded(e){if(!e)return l.createEmpty();try{return l.decode(e)}catch(e){return l.createMalformed()}}static removeFromUrl(e){return d(e,e=>{let t=new((0,a("dVSJk").getEnv)()).URLSearchParams(e);return t.delete(n),t.toString()})}static decode(e){let t=(0,a("gOS5u").decode)(e);return new l(t)}encode(){return(0,a("gOS5u").encode)({id:this.id,product:this.product})}addToUrl(e){return d(e,e=>{let t=new((0,a("dVSJk").getEnv)()).URLSearchParams(e);return t.set(n,this.encode()),t.toString()})}isEmpty(){return!1}isMalformed(){return!this.isEmpty()&&!this.isValid()}isValid(){return!0}toAnalyticsAttributes({transformValue:e=e=>null===e?void 0:e,hasGeneratedId:t=!1}={}){return{[t?"originIdGenerated":"originId"]:e(this.id),originProduct:e(this.product),...o}}validate(){if(!l.isValidId(this.id))throw TypeError("Invalid Origin id");if(!l.isValidProduct(this.product))throw TypeError("Missing/invalid Origin product")}}class c extends l{constructor(){super({id:null,product:null,dangerouslySkipValidation:!0})}isValid(){return!1}isEmpty(){return!0}toAnalyticsAttributes(){return{...o}}}class u extends l{constructor(){super({id:null,product:null,dangerouslySkipValidation:!0})}isValid(){return!1}isEmpty(){return!1}toAnalyticsAttributes(){return{originMalformed:!0,...o}}}function d(e,t){let s=String(e);return s.replace(/(^[^?#]*)(?:\?)?([^#]*?)(#.*|$)$/,(e,s,r,i)=>{let a=t(r);return a&&(a=`?${a}`),`${s}${a}${i}`})}}),n("gOS5u",function(t,s){e(t.exports,"encode",()=>i),e(t.exports,"decode",()=>n);let r={confluence:"c",jira:"j",stride:"s",bitbucket:"b",trello:"t"};function i(e){let t=JSON.stringify(function({id:e,product:t}){return{i:e,p:t&&t in r?r[t]:t}}(e)),s=(0,a("dVSJk").getEnv)().btoa(t);return(0,a("eDSsA").base64ToBase64Url)(s)}function n(e){let t=(0,a("eDSsA").base64UrlToBase64)(e),s=(0,a("dVSJk").getEnv)().atob(t);return function(e){let t={};return e.i&&(t.id=e.i),e.p&&(t.product=function(e){let t=Object.keys(r);for(let s=0;s<t.length;s++){let i=t[s],a=r[i];if(e===a)return i}return e}(e.p)),t}(JSON.parse(s))}}),n("eDSsA",function(t,s){function r(e){return null==e?"":String(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function i(e){if(null==e)return"";let t=String(e).replace(/-/g,"+").replace(/_/g,"/"),s=(4-e.length%4)%4;return t+"===".slice(0,s)}e(t.exports,"base64ToBase64Url",()=>r),e(t.exports,"base64UrlToBase64",()=>i)}),n("dVSJk",function(t,s){let r;e(t.exports,"getEnv",()=>o);var i=a("aul3P");let n=()=>({atob:"function"==typeof atob&&atob.bind(void 0)||void 0!==i.Buffer&&(e=>(0,i.Buffer).from(e,"base64").toString()),btoa:"function"==typeof btoa&&btoa.bind(void 0)||void 0!==i.Buffer&&(e=>(0,i.Buffer).from(e).toString("base64")),URLSearchParams:"function"==typeof URLSearchParams&&URLSearchParams||a("78Ywx").URLSearchParams}),o=()=>r||(r=l(n())),l=e=>{if(!(e.atob&&e.btoa&&e.URLSearchParams))throw TypeError("Origin-Tracing: missing environment APIs. Required: btoa(), atob(), URLSearchParams() (or in Node: Buffer, require('url').URLSearchParams).");return e}}),n("abpf4",function(t,s){e(t.exports,"CompressionRule",()=>r);class r{constructor(e,t){if(this.canCompress=e=>{try{return e&&(0,a("6cTjW").isActionEventType)(e.eventType)&&this.predicate(e)}catch(e){return!1}},this.compress=e=>{let[t,s]=(0,a("7CSD8").partition)(e,e=>this.canCompress(e)),r=this.compressFn(t);if(!r)throw Error("No events were returned from the compression function");return r.forEach(e=>{(0,a("6cTjW").validateActionEventType)(e.eventType),(0,a("6cTjW").validateActionEvent)(e)}),r.concat(s)},"function"!=typeof e)throw Error("Invalid predicate, must be a function that accepts an event and returns a boolean");if("function"!=typeof t)throw Error("Invalid compressFn, must be a function that both accepts and returns an array of events");this.predicate=e,this.compressFn=t}}}),n("6cTjW",function(t,s){e(t.exports,"validateContainers",()=>i),e(t.exports,"isActionEventType",()=>n),e(t.exports,"validateActionEventType",()=>o),e(t.exports,"validateActionEvent",()=>l),e(t.exports,"validateScreenEvent",()=>c),e(t.exports,"validateTrackEvent",()=>u),e(t.exports,"validateDwellBaseEvent",()=>d),e(t.exports,"validateUIEvent",()=>h),e(t.exports,"validateOperationalEvent",()=>p),e(t.exports,"validateIdentifyEvent",()=>g),e(t.exports,"validatePlatform",()=>m);let r=Object.freeze([a("9Q7Jj").eventType.OPERATIONAL,a("9Q7Jj").eventType.TRACK,a("9Q7Jj").eventType.UI]);function i(e){if(e){if(e&&e.constructor!==Object)throw Error("properties.containers must be an Object");Object.values(e).forEach(e=>(function(e){if(!(0,a("kXF2I").isPlainObject)(e))throw Error("properties.containers must be an Object");if(!("id"in e))throw Error("properties.containers is missing field 'id'");if("string"!=typeof e.id)throw Error("properties.containers.id must be of type String");if("type"in e&&"string"!=typeof e.type)throw Error("properties.containers.type must be of type String")})(e))}}function n(e){switch(e){case a("9Q7Jj").eventType.OPERATIONAL:case a("9Q7Jj").eventType.TRACK:case a("9Q7Jj").eventType.UI:return!0;default:return!1}}function o(e){if(!n(e))throw Error(`Invalid action event type: ${e}, must be one of: [${r}]`);return!0}function l(e){if(!e)throw Error("Missing event");if(!e.source)throw Error("Missing event.source");if(!e.actionSubject)throw Error("Missing event.actionSubject");if(!e.action)throw Error("Missing event.action");i(e.containers)}function c(e){if(!e)throw Error("Missing name")}function u(e){l(e)}function d(e){if(!e)throw Error("Missing event");if(!e.source)throw Error("Missing event.source");if(!e.actionSubject)throw Error("Missing event.actionSubject")}function h(e){l(e)}function p(e){l(e)}function g(e,t){if(!e)throw Error("Missing userIdType");if(!t)throw Error("Missing userId");if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").userType,e))throw Error(`Invalid userIdType '${e}', must be an userType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").userType)}]`)}function m(e){if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").platformType,e.platform))throw Error(`Invalid productInfo.platform '${e.platform}', must be a platformType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").platformType)}]`);if(e.origin===a("9Q7Jj").originType.DESKTOP&&!(0,a("9Q7Jj").isType)(a("9Q7Jj").desktopPlatforms,e.platform))throw Error(`Invalid productInfo.platform '${e.platform}', must be one of [mac, linux, windows]`);if(e.origin===a("9Q7Jj").originType.WEB&&!(0,a("9Q7Jj").isType)(a("9Q7Jj").webPlatforms,e.platform))throw Error(`Invalid productInfo.platform '${e.platform}', must be one of [web, mobileWeb]`)}}),n("9Q7Jj",function(t,s){var r,i,a,n,o,l,c,u,d,h,p,g,m,f,y,E,v,I,b,T;e(t.exports,"envType",()=>r),e(t.exports,"eventType",()=>i),e(t.exports,"platformType",()=>a),e(t.exports,"originType",()=>n),e(t.exports,"tenantType",()=>o),e(t.exports,"userType",()=>l),e(t.exports,"apdexType",()=>c),e(t.exports,"desktopPlatforms",()=>w),e(t.exports,"webPlatforms",()=>S),e(t.exports,"originTracingType",()=>u),e(t.exports,"objectValues",()=>A),e(t.exports,"isType",()=>_),e(t.exports,"perimeterType",()=>d),e(t.exports,"aliasType",()=>h),e(t.exports,"groupType",()=>p),(m=r||(r={})).LOCAL="local",m.DEV="dev",m.STAGING="staging",m.PROD="prod",(f=i||(i={})).TRACK="track",f.UI="ui",f.OPERATIONAL="operational",f.SCREEN="screen",f.IDENTIFY="identify",(y=a||(a={})).MAC="mac",y.LINUX="linux",y.WINDOWS="windows",y.DESKTOP="desktop",y.WEB="web",y.MOBILE_WEB="mobileWeb",(E=n||(n={})).DESKTOP="desktop",E.WEB="web",(v=o||(o={})).CLOUD_ID="cloudId",v.ORG_ID="orgId",v.OPSGENIE_CUSTOMER_ID="opsgenieCustomerId",v.HALP_TEAM_ID="halpTeamId",v.TRANSACTION_ACCOUNT_ID="transactionAccountId",v.TRELLO_WORKSPACE_ID="trelloWorkspaceId",v.NONE="none",(I=l||(l={})).ATLASSIAN_ACCOUNT="atlassianAccount",I.HASHED_EMAIL="hashedEmail",I.TRELLO="trello",I.OPSGENIE="opsgenie",I.HALP="halp",(b=c||(c={})).TRANSITION="transition",b.INITIAL_LOAD="initialLoad";let w=Object.freeze(["desktop","mac","linux","windows"]),S=Object.freeze(["web","mobileWeb"]);function A(e){return Object.values(e)}function _(e,t){return Object.values(e).indexOf(t)>-1}(u||(u={})).ATL_ORIGIN="atlOrigin",(T=d||(d={})).C5="c5",T.COMMERCIAL="commercial",T.FEDRAMP_MODERATE="fedramp-moderate",T.FEDRAMP_HIGH="fedramp-high",h||(h={}),(p||(p={})).TRANSACTION_ACCOUNT_ID="transactionAccountId",g||(g={})}),n("kXF2I",function(t,s){function r(e){return!0==(null!==e&&"object"==typeof e&&!1===Array.isArray(e))&&"[object Object]"===Object.prototype.toString.call(e)}function i(e){if(!1===r(e))return!1;let t=e.constructor;if("function"!=typeof t)return!1;let s=t.prototype;return!1!==r(s)&&"isPrototypeOf"in s}e(t.exports,"isPlainObject",()=>i)}),n("7CSD8",function(t,s){e(t.exports,"mapKeys",()=>r),e(t.exports,"pick",()=>i),e(t.exports,"omitBy",()=>a),e(t.exports,"pickBy",()=>n),e(t.exports,"omit",()=>o),e(t.exports,"equals",()=>l),e(t.exports,"partition",()=>c);let r=(e,t)=>Object.keys(e).reduce((s,r)=>{let i=t(e[r],r,e);return s[i]=e[r],s},{}),i=(e,t)=>t.reduce((t,s)=>(s in e&&(t[s]=e[s]),t),{}),a=(e,t)=>Object.keys(e).filter(s=>!t(e[s],s)).reduce((t,s)=>(t[s]=e[s],t),{}),n=(e,t)=>Object.keys(e).filter(s=>t(e[s],s)).reduce((t,s)=>(t[s]=e[s],t),{}),o=(e,t)=>Object.keys(e).filter(e=>0>t.indexOf(e)).reduce((t,s)=>(t[s]=e[s],t),{}),l=(e,t)=>{if(e===t)return!0;if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return e===t;if(e.prototype!==t.prototype)return!1;let s=Object.keys(e);return s.length===Object.keys(t).length&&s.every(s=>l(e[s],t[s]))},c=(e,t)=>e.reduce((e,s,r,i)=>(e[t(s,r,i)?0:1].push(s),e),[[],[]])}),n("4si91",function(s,r){e(s.exports,"default",()=>o);var i=a("dFBS3");let n="last.screen.event";class o{constructor(e,s={}){if(this._useStargate=e=>null==e||e,this._endsWith=(e,t)=>-1!==e.indexOf(t,e.length-t.length),this._changeInternalUserId=(e,t)=>{this.eventProcessor.getUser().setUserId(e),t&&t!==this.eventProcessor.getUser().getAnonymousId()&&this.eventProcessor.getUser().setAnonymousId(t)},this._createSubproductGetter=e=>(0,a("PPCUq").default)(e,"Cannot get subproduct from the callback. Proceeding without it."),this._createEmbeddedProductGetter=e=>(0,a("PPCUq").default)(e,"Cannot get embeddedProduct from the callback. Proceeding without it."),this._getLastScreenEvent=()=>{try{return JSON.parse(this._safeSessionStorage.getItem(n)||"")}catch(e){return this._safeSessionStorage.removeItem(n),null}},this._setLastScreenEvent=e=>{this._safeSessionStorage.setItem(n,JSON.stringify({name:e.name,attributes:e.attributes}))},this._shouldEventBeDelayed=e=>{if(!e.tags||-1===e.tags.indexOf("measurement"))return!1;let t=!1!==e.highPriority;return this.eventDelayQueue.isDelayingLowPriorityEvents()&&!t},this._fireEvent=(e,t,s,r)=>{switch(t.eventType){case a("9Q7Jj").eventType.UI:case a("9Q7Jj").eventType.OPERATIONAL:case a("9Q7Jj").eventType.TRACK:return this.eventProcessor.track(e,t,s,r);case a("9Q7Jj").eventType.SCREEN:return this.eventProcessor.page(e,t,s,r);case a("9Q7Jj").eventType.IDENTIFY:return this.eventProcessor.identify(e,t,s,r);default:throw Error(`No handler has been defined for events of type ${t.eventType}`)}},this._fireDelayedEvent=(e,t,s,r)=>{try{this._changeInternalUserId(r.userId,r.anonymousId),t.tags=[...t.tags||[],"sentWithDelay"],this._fireEvent(e,t,s,void 0)}finally{this._changeInternalUserId(this._userInfo.userId,this._userInfo.anonymousId)}},this._delayEvent=(e,t,s,r,i)=>{this.eventDelayQueue.push(e,t,s,r),i&&i()},this._processEvent=(e,t,s,r)=>(this._testingCache.saveEvent(t),this._shouldEventBeDelayed(t))?(this._delayEvent(e,t,s,this._userInfo,r),Promise.resolve()):this._fireEvent(e,t,s,r),this.setEmbeddedProduct=e=>{this._productInfo.embeddedProduct=this._createEmbeddedProductGetter(e),this.resetUIViewedTimers()},this.clearEmbeddedProduct=()=>{this._productInfo.embeddedProduct=this._createEmbeddedProductGetter(null)},this.setSubproduct=e=>{this._productInfo.subproduct=this._createSubproductGetter(e),this.resetUIViewedTimers()},this.setOriginTracingHandlers=e=>{let t=this.originTracing.handleOriginParameters(e,this._historyReplaceFn);Object.keys(t).forEach(e=>{void 0!==t[e].taskSessionId&&this.task.createTaskSessionWithProvidedId(e,t[e].taskSessionId)});let s={};return(Object.keys(t).forEach(e=>{t[e].originTracingAttributes?s[e]=t[e].originTracingAttributes:console.warn(`Handling method for origin parameter ${e} has not returned any attributes`)}),Object.keys(t).length>0)?this.sendOperationalEvent({action:"landed",actionSubject:"origin",source:"webClient",attributes:{originTracesLanded:s}},()=>{}):Promise.resolve()},this.setTenantInfo=(e,t)=>{if(!e)throw Error("Missing tenantIdType");if(e!==a("9Q7Jj").tenantType.NONE&&!t)throw Error("Missing tenantId");if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").tenantType,e))throw Error(`Invalid tenantIdType '${e}', must be an tenantType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").tenantType)}]`);this._tenantInfo={tenantIdType:e,tenantId:t}},this.clearTenantInfo=()=>{this._tenantInfo={}},this.setOrgInfo=e=>{if(!e)throw Error("Missing orgId");this._orgInfo={orgId:e}},this.clearOrgInfo=()=>{this._orgInfo={}},this.setWorkspaceInfo=e=>{if(!e)throw Error("Missing workspaceId");this._workspaceInfo={workspaceId:e}},this.clearWorkspaceInfo=()=>{this._workspaceInfo={}},this.setUserInfo=(e,t)=>{(0,a("6cTjW").validateIdentifyEvent)(e,t),this._changeInternalUserId(t),this._userInfo={userIdType:e,userId:t,anonymousId:this.eventProcessor.getUser().getAnonymousId()}},this.clearUserInfo=()=>{this._changeInternalUserId(void 0),this._userInfo={anonymousId:this.eventProcessor.getUser().getAnonymousId()}},this.setAlias=(e,t)=>{if(!e)throw Error("Missing aliasType");if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").aliasType,e))throw Error(`Invalid aliasType '${e}', must be an aliasType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").aliasType)}]`);this._aliases[e]=t},this.clearAlias=()=>{this._aliases={}},this.setGroup=(e,t)=>{if(!e)throw Error("Missing groupType");if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").groupType,e))throw Error(`Invalid groupType '${e}', must be an groupType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").groupType)}]`);this._groups[e]=t},this.clearGroup=()=>{this._groups={}},this.getAnonymousId=()=>this._userInfo.anonymousId,this.setUIViewedAttributes=e=>{if(!e)throw Error("Missing uiViewedAttributes");if("object"!=typeof e||Array.isArray(e))throw Error("Invalid uiViewedAttributes type, should be a non array object");this._uiViewedAttributes={...e}},this.getUIViewedAttributes=()=>this._uiViewedAttributes,this.clearUIViewedAttributes=()=>{this._uiViewedAttributes={}},this.sendIdentifyEvent=(e,t,s)=>{this.setUserInfo(e,t);let r={userIdType:e,eventType:a("9Q7Jj").eventType.IDENTIFY};return this._processEvent(t,r,this._context,s)},this.sendPageEvent=(e,t)=>this.sendScreenEvent(e,t),this.sendScreenEvent=(e,t,s)=>{let r,i,n,o;"object"==typeof e?(r=e.name,i=e.attributes,n=e.containers,o=e.tags):(r=e,i=s),(0,a("6cTjW").validateScreenEvent)(r),(0,a("6cTjW").validateContainers)(n);let l=(0,a("25Azf").buildScreenEvent)(this._productInfo,this._tenantInfo,this._userInfo,i,e.nonPrivacySafeAttributes,o,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId,this._workspaceInfo,e,n,this._aliases,this._groups),c={name:r,...l};return this._setLastScreenEvent(c),this._processEvent(r,c,this._context,(0,a("lSU8C").default)(t,c))},this.sendTrackEvent=(e,t)=>{(0,a("6cTjW").validateTrackEvent)(e);let s=(0,a("25Azf").buildActionEvent)(this._productInfo,this._tenantInfo,this._userInfo,e,a("9Q7Jj").eventType.TRACK,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId,this._workspaceInfo,this._aliases,this._groups);return this._processEvent((0,a("25Azf").buildActionName)(e),s,this._context,(0,a("lSU8C").default)(t,s))},this.sendUIEvent=(e,t)=>{(0,a("6cTjW").validateUIEvent)(e);let s=(0,a("25Azf").buildActionEvent)(this._productInfo,this._tenantInfo,this._userInfo,e,a("9Q7Jj").eventType.UI,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId,this._workspaceInfo,this._aliases,this._groups);return this._processEvent((0,a("25Azf").buildActionName)(e),s,this._context,(0,a("lSU8C").default)(t,s))},this.sendOperationalEvent=(e,t)=>{(0,a("6cTjW").validateOperationalEvent)(e);let s=(0,a("25Azf").buildActionEvent)(this._productInfo,this._tenantInfo,this._userInfo,e,a("9Q7Jj").eventType.OPERATIONAL,this._tabTracking.getCurrentTabId(),this._sessionTracking.getCurrentSessionId(),this.task.getAllTaskSessions(),this._orgInfo,this._pageLoadId,this._workspaceInfo,this._aliases,this._groups);return this._processEvent((0,a("25Azf").buildActionName)(e),s,this._context,(0,a("lSU8C").default)(t,s))},this.startUIViewedEvent=e=>{this.stopUIViewedEvent(),this._uiViewedEvent=new(a("jmu0Y")).default(this._productInfo,()=>({embeddedProduct:this._productInfo.embeddedProduct(),subproduct:this._productInfo.subproduct(),tenantIdType:this._tenantInfo.tenantIdType,tenantId:this._tenantInfo.tenantId,userId:this._userInfo.userId,lastScreenEvent:this._getLastScreenEvent(),attributes:this._uiViewedAttributes}),t=>this.sendUIEvent(t,e)),this._uiViewedEvent.start()},this.stopUIViewedEvent=()=>{this._uiViewedEvent&&(this._uiViewedEvent.stop(),this._uiViewedEvent=null)},this.resetUIViewedTimers=()=>{this._uiViewedEvent&&this._uiViewedEvent.resetTimers()},this.startApdexEvent=e=>{this._apdexEvent.start(e)},this.getApdexStart=e=>this._apdexEvent.getStart(e),this.stopApdexEvent=(e,t)=>{this._apdexEvent.stop(e,t)},this.startLowPriorityEventDelay=(e,t)=>{this.eventDelayQueue.startLowPriorityEventDelay(e,t)},this.stopLowPriorityEventDelay=()=>{this.eventDelayQueue.stopLowPriorityEventDelay()},this.onEvent=(e,t)=>{if(!t)throw Error("Missing analyticsData");if(!t.eventType)throw Error("Missing analyticsData.eventType");if(t.eventType===a("9Q7Jj").eventType.TRACK)return this.sendTrackEvent(t);if(t.eventType===a("9Q7Jj").eventType.UI)return this.sendUIEvent(t);if(t.eventType===a("9Q7Jj").eventType.OPERATIONAL)return this.sendOperationalEvent(t);if(t.eventType===a("9Q7Jj").eventType.SCREEN)return this.sendScreenEvent(t.name,null,t.attributes);if(t.eventType===a("9Q7Jj").eventType.IDENTIFY)return this.sendIdentifyEvent(t.userIdType,t.userId);throw Error(`Invalid analyticsData.eventType '${t.eventType}', must be an eventType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").eventType)}]`)},!e)throw Error("Missing productInfo");if(!e.env)throw Error("Missing productInfo.env");if(!e.product)throw Error("Missing productInfo.product");if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").envType,e.env))throw Error(`Invalid productInfo.env '${e.env}', must be an envType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").envType)}]`);if(e.perimeter&&!(0,a("9Q7Jj").isType)(a("9Q7Jj").perimeterType,e.perimeter))throw Error(`Invalid productInfo.perimeter '${e.perimeter}', must be an perimeterType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").perimeterType)}]`);if(e.origin){if(!(0,a("9Q7Jj").isType)(a("9Q7Jj").originType,e.origin))throw Error(`Invalid productInfo.origin '${e.origin}', must be an originType: [${(0,a("9Q7Jj").objectValues)(a("9Q7Jj").originType)}]`)}else e.origin=a("9Q7Jj").originType.WEB;e.platform?(0,a("6cTjW").validatePlatform)(e):e.platform=e.origin===a("9Q7Jj").originType.WEB?a("9Q7Jj").platformType.WEB:a("9Q7Jj").platformType.DESKTOP,this.logger=s.logger||console,this._productInfo={...e,subproduct:this._createSubproductGetter(e.subproduct),embeddedProduct:this._createEmbeddedProductGetter(e.embeddedProduct)},this._tenantInfo={},this._orgInfo={},this._uiViewedAttributes={},this._context=(0,a("25Azf").buildContext)(this._productInfo),this._safeSessionStorage=new(a("9cB7N")).default;let r=this._useStargate(s.useStargate),o=s.apiHost||(0,a("3x9by").selectHost)({useStargate:r,env:e.env,useLegacyUrl:s.useLegacyUrl,perimeter:e.perimeter,envOverride:e.envOverride}),l=s.apiHostProtocol||"https",c=s.minRetryDelay||1e3,u={maxRetryDelay:6e4,minRetryDelay:c,backoffFactor:2,flushWaitMs:s.flushWaitInterval,flushBeforeUnload:s.flushBeforeUnload},d=`awc-${e.env}`,h=s.disableCookiePersistence||!1;this.eventProcessor=new(a("kVbF6")).default({apiHost:o,apiHostProtocol:l,product:e.product,retryQueuePrefix:d,retryQueueOptions:u,xidPromiseGetter:()=>(0,a("4uAp5").XIDPromise)(s.xidConsent,s.xidPromiseFn),logger:this.logger,disableCookiePersistence:h}),this._userInfo={anonymousId:this.eventProcessor.getUser().getAnonymousId(s?.customAnonymousIdGenerator)},this._pageVisibility=new(a("jro5S")).default,this._tabTracking=new(a("fvEdY")).default,this._sessionTracking=new(a("dmP6K")).default({sessionExpiryTime:s.sessionExpiryTime,onNewSessionStarted:s.onNewSessionStarted}),this.task=new(a("hMvQq")).default,this.originTracing=new(a("f7rk3")).default,this._apdexEvent=new(a("61E1T")).default(this.sendOperationalEvent,this._pageVisibility),this._historyReplaceFn="function"==typeof s.historyReplaceFn?s.historyReplaceFn:a("gldVk").defaultHistoryReplaceFn,this.eventDelayQueue=new(a("cHc3w")).default(this._fireDelayedEvent,s.delayQueueCompressors||[]),this._testingCache=new(a("2JP86")).default,this._pageLoadId=t(i)(),this._workspaceInfo={},this._aliases={},this._groups={}}}}),n("61E1T",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t){if(this._getEventKey=({task:e,taskId:t})=>t?`${e}.${t}`:e,this._getEventTimingByName=e=>{let t=this._performance.getEntriesByName(e),s=t[t.length-1];return s},this._getApdexFields=e=>{let t=this._getApdexTimings(e),s=this._calculateApdex({duration:t.duration,threshold:e.threshold});return{...t,apdex:s}},this._getApdexTimings=e=>{let t=this._getEventKey(e),s=`${t}-start`,r=e.startTime||this._getStartTime(e,s),i=e.stopTime||this._getStopTime();return this._cleanApdexState(t),{startTime:r,stopTime:i,duration:i-r}},this._getStartTime=(e,t)=>{let s;let r=this._performance.getTimeOrigin();if(e.type===a("9Q7Jj").apdexType.INITIAL_LOAD)s=r;else{let e=this._getEventTimingByName(t);s=r+e.startTime}return s},this._getStopTime=()=>this._performance.getTimeOrigin()+this._performance.now(),this._cleanApdexState=e=>{this._performance.clearMarks(`${e}-start`),this._performance.clearMarks(`${e}-stop`),this._startedEvents.delete(e)},this._getVisibilityFields=e=>{let t;if(e.type===a("9Q7Jj").apdexType.INITIAL_LOAD)t=!this._wasPreviouslyHidden;else if(e.type===a("9Q7Jj").apdexType.TRANSITION){let s=this._getEventKey(e);t=this._isActiveEvents.get(s)}return(e.startTime||e.stopTime)&&(t=!this._pageVisibility.getIsHidden()),{isActiveTab:t}},this._calculateApdex=({duration:e,threshold:t=this._threshold})=>e<=t?1:e<=4*t?.5:0,this._validateStartEvent=e=>{if(!e)throw Error('Missing "event" in Apdex start event');if(!e.task)throw Error('Missing "task" in Apdex start event');if("string"!=typeof e.task)throw Error('Invalid "task" in Apdex start event');if(e.taskId&&"string"!=typeof e.taskId)throw Error('Invalid "taskId" in Apdex start event')},this._validateStopEvent=e=>{if(!e)throw Error('Missing "event" in Apdex stop event');if(!e.task)throw Error('Missing "task" in Apdex stop event');if("string"!=typeof e.task)throw Error('Invalid "task" in Apdex stop event');if(e.taskId&&"string"!=typeof e.taskId)throw Error('Invalid "taskId" in Apdex stop event');if(!e.type)throw Error('Missing "type" in Apdex stop event');if(e.type&&!(0,a("9Q7Jj").isType)(a("9Q7Jj").apdexType,e.type))throw Error('Invalid "type" in Apdex stop event');if(e.threshold&&"number"!=typeof e.threshold)throw Error('Invalid "threshold" in Apdex stop event');if(!e.startTime&&e.type===a("9Q7Jj").apdexType.TRANSITION){let t=this._getEventKey(e);if(!this._startedEvents.has(t))throw Error(`Apdex event transition "${t}" was not started`)}if(e.startTime&&!("number"==typeof e.startTime&&e.startTime>=0))throw Error('Invalid "startTime" in Apdex stop event');if(e.stopTime&&"number"!=typeof e.stopTime)throw Error('Invalid "stopTime" in Apdex stop event');if(e.stopTime<=e.startTime)throw Error('"stopTime" should be greater than "startTime" in Apdex stop event')},this._shouldSendEvent=e=>!!e&&"number"==typeof e.apdex,this._sendEvent=(e,t)=>{this._shouldSendEvent(e)&&this._onEvent({source:"ui",action:"readyForUser",actionSubject:"ui",attributes:{...e.additionalAttributes,task:e.task,taskId:e.taskId,type:e.type,threshold:e.threshold||this._threshold,apdex:e.apdex,startTime:e.startTime,stopTime:e.stopTime,duration:e.duration,isActiveTab:e.isActiveTab}},t)},!e)throw Error("Missing onEvent callback");if("function"!=typeof e)throw Error("Invalid onEvent, must be function");if(!(t instanceof a("jro5S").default))throw Error("Invalid pageVisibility, must be PageVisibility class");this._startedEvents=new Map,this._performance=new(a("90c4d")).default,this._onEvent=e,this._threshold=1e3,this._wasPreviouslyHidden=t.getIsHidden(),this._isActiveEvents=new Map,this._pageVisibility=t,this._pageVisibility.addCallback("apdexEvent",e=>{this.onVisibilityChange(!e)})}start(e){if(this._validateStartEvent(e),!this._performance.isAvailable())return;let t=this._getEventKey(e),s=`${t}-start`;this._startedEvents.set(t,!0),this._isActiveEvents.set(t,!this._pageVisibility.getIsHidden()),this._performance.clearMarks(s),this._performance.mark(s)}getStart(e){if(this._validateStartEvent(e),!this._performance.isAvailable())return;let t=this._getEventKey(e),s=`${t}-start`;return this._getEventTimingByName(s)}stop(e,t){if(this._validateStopEvent(e),!this._performance.isAvailable())return;let s=this._getApdexFields(e),r=this._getVisibilityFields(e);this._sendEvent({...e,...s,...r},t)}onVisibilityChange(e){e||(this._wasPreviouslyHidden=!0,Array.from(this._isActiveEvents.keys()).forEach(e=>this._isActiveEvents.set(e,!1)))}}}),n("jro5S",function(t,s){e(t.exports,"default",()=>r);class r{constructor(){this._bindEventListeners=()=>{document.addEventListener(this._visibilityChange,this._handleVisibilityChange,!1)},this._handleVisibilityChange=()=>{let e=document[this._hidden];this._isHidden=e,this._callbacks.forEach(t=>t(e))},this._isHidden=!1,this._callbacks=new Map,this._hidden=void 0,this._visibilityChange=void 0,"undefined"!=typeof document&&(void 0!==document.hidden?(this._isHidden=document.hidden,this._hidden="hidden",this._visibilityChange="visibilitychange"):void 0!==document.msHidden?(this._isHidden=document.msHidden,this._hidden="msHidden",this._visibilityChange="msvisibilitychange"):void 0!==document.webkitHidden&&(this._isHidden=document.webkitHidden,this._hidden="webkitHidden",this._visibilityChange="webkitvisibilitychange"),void 0!==document.addEventListener&&void 0!==this._hidden&&this._bindEventListeners())}addCallback(e,t){if("string"!=typeof e)throw Error("Invalid name, must be string");if("function"!=typeof t)throw Error("Invalid callback, must be function");this._callbacks.set(e,t)}removeCallback(e){this._callbacks.has(e)&&this._callbacks.delete(e)}getIsHidden(){return this._isHidden}}}),n("90c4d",function(t,s){e(t.exports,"default",()=>r);class r{constructor(){this._performance=window.performance}clearMarks(...e){this._performance&&this._performance.clearMarks&&this._performance.clearMarks(...e)}mark(...e){this._performance&&this._performance.mark&&this._performance.mark(...e)}getEntriesByName(...e){return this._performance&&this._performance.getEntriesByName?this._performance.getEntriesByName(...e):[]}getTimeOrigin(){return this._performance&&(this._performance.timeOrigin||this._performance.timing)?this._performance.timeOrigin||this._performance.timing.navigationStart:0}now(){return this._performance&&this._performance.now?this._performance.now():Date.now?Date.now():+new Date}isAvailable(){return!!this._performance&&!!this._performance.clearMarks&&!!this._performance.mark&&!!this._performance.getEntriesByName&&!!this._performance.timing}}}),n("PPCUq",function(t,s){e(t.exports,"default",()=>i);let r=e=>"function"==typeof e;var i=(e,t)=>()=>{if(r(e))try{return e()}catch(e){console.error(`${t} - ${e instanceof Error?e.message:String(e)}`);return}return e}}),n("25Azf",function(t,s){function r(e){return{tenantIdType:e.tenantIdType,tenantId:e.tenantId}}function i(e){return{userIdType:e.userIdType}}function n(e){return{orgId:e.orgId}}function o(e){return{workspaceId:e.workspaceId}}function l(e){if(p(e))return{aliases:e}}function c(e){if(p(e))return{groups:e}}function u(e){return e.anonymousId?{anonymousId:e.anonymousId}:{}}function d(e,t){return void 0===t?e:t}function h(e,t){let s=t||{},r=d(e.env,s.env),i=d(e.product,s.product),a=d(e.subproduct(),s.subproduct),n=d(e.version,s.version),o=d(e.origin,s.origin),l=d(e.platform,s.platform);return{env:r,product:i,subproduct:a,version:n,origin:o,platform:l}}function p(e){return(0,a("kXF2I").isPlainObject)(e)&&Object.keys(e).length>0}function g(e,t){return p(t)?{[e]:t}:void 0}function m(e){if(p(e)){let t=function(e){let t={};return Object.keys(e).forEach(s=>{let r=e[s];t[s]={id:r.id,type:r.type}}),t}(e);return g("containers",t)}}function f(e,t){return{containerType:e.containerType,containerId:e.containerId,source:e.source,objectType:e.objectType,objectId:e.objectId,actionSubject:e.actionSubject,action:e.action,actionSubjectId:e.actionSubjectId,attributes:e.attributes,nonPrivacySafeAttributes:e.nonPrivacySafeAttributes,tags:e.tags,highPriority:e.highPriority,eventType:t,...m(e.containers)}}function y(e,t,s,d,p,f,y,E,v,I,b,T,w,S,A,_){let C=h(e),x=r(t),k=i(s),O=n(I),D=o(T),N={title:"",path:"",url:"",referrer:"",search:"",eventType:a("9Q7Jj").eventType.SCREEN};return{...C,...x,...k,...O,...N,...g("attributes",d),...g("nonPrivacySafeAttributes",p),...m(S),...u(w),tags:f,tabId:y,sessionId:E,taskSessions:v,pageLoadId:b,...D,...l(A),...c(_)}}function E(e){return`${e.actionSubject} ${e.action}`}function v(e){let t=window.screen||{};return{context:{locale:e.locale,screen:{width:t.width,height:t.height,density:window.devicePixelRatio},library:{name:"analytics.js",version:"0.0.0-use.local"}}}}function I(e,t,s,a,d,p,g,m,y,E,v,I,b){let T=h(e,function(e){let{env:t,product:s,subproduct:r,version:i,origin:a,platform:n}=e;return{env:t,product:s,subproduct:r,version:i,origin:a,platform:n}}(a)),w=r(t),S=n(y),A=o(v),_=i(s),C=f(a,d);return{...T,...w,...S,..._,...C,...u(a),tabId:p,sessionId:g,taskSessions:m,pageLoadId:E,...A,...l(I),...c(b)}}e(t.exports,"buildActionFields",()=>f),e(t.exports,"buildScreenEvent",()=>y),e(t.exports,"buildActionName",()=>E),e(t.exports,"buildContext",()=>v),e(t.exports,"buildActionEvent",()=>I)}),n("cHc3w",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t){this.push=(e,t,s,r)=>{this.delayQueue.push(e,t,s,r)},this.startLowPriorityEventDelay=(e=c,t)=>{if(Number.isNaN(e)||e<=0)throw Error(`Invalid timeout period: ${e}, must be a number greater than 0`);this.delayTimeout&&clearTimeout(this.delayTimeout),this.delayCallback=t,this.delayTimeout=setTimeout(()=>this.stopLowPriorityEventDelay(a("6UZcF").StopLowPriorityEventDelayReason.TIMEOUT),e?Math.min(e,u):u),this.delayQueue.cancelFlush(),this.isDelaying=!0},this.stopLowPriorityEventDelay=(e=a("6UZcF").StopLowPriorityEventDelayReason.MANUAL)=>{this.delayTimeout&&(clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.delayQueue.startFlush(),this.isDelaying=!1,this.delayCallback?.(e),this.delayCallback=void 0},this.isDelayingLowPriorityEvents=()=>this.isDelaying,this.isDelaying=!1,this.delayQueue=new(a("gt0B6")).default(e,t)}}});const c=1e4,u=3e4;n("gt0B6",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t){this.push=(e,t,s,r)=>{this.eventArgs.push({identifier:e,builtEvent:t,context:s,userInfo:r})},this.size=()=>this.eventArgs.length,this.startFlush=()=>{try{this.eventArgs=this.compressEventArgs(this.eventArgs)}catch(e){console.warn(`Failed to perform compression on the delayed analytics events. Error: ${e.message}. Sending ${this.eventArgs.length} uncompressed events instead`)}this.flushNextBatch()},this.cancelFlush=()=>{this.flushBatchTimeout&&(clearTimeout(this.flushBatchTimeout),this.flushBatchTimeout=null)},this.flushNextBatch=()=>{let e=this.eventArgs.splice(0,7);e.forEach(e=>this.processFn(e.identifier,e.builtEvent,e.context,e.userInfo)),this.eventArgs.length>0?this.flushBatchTimeout=setTimeout(()=>this.flushNextBatch(),100):this.flushBatchTimeout=null},this.compressEventArgs=e=>{let[t,s]=(0,a("7CSD8").partition)(e,e=>this.compressor.canCompress(e.builtEvent)),r=t.reduce((e,t)=>{let s=e.find(e=>(0,a("7CSD8").equals)(e.userInfo,t.userInfo)&&(0,a("7CSD8").equals)(e.context,t.context));return s?s.eventArgs.push(t):e.push({userInfo:t.userInfo,context:t.context,eventArgs:[t]}),e},[]),i=r.reduce((e,t)=>{try{let s=t.eventArgs.map(e=>e.builtEvent),r=this.compressor.compress(s),i=r.map(e=>({identifier:(0,a("25Azf").buildActionName)(e),builtEvent:e,userInfo:t.userInfo,context:t.context}));return e.concat(i)}catch(e){return console.warn(`Failed to compress some analytics events. Error: ${e.message}. Sending ${t.eventArgs.length} uncompressed events instead`),t.eventArgs}},[]);return s.forEach(e=>i.push(e)),i},this.processFn=e,this.flushBatchTimeout=null,this.eventArgs=[],this.compressor=new(a("fCZfY")).default(t)}}}),n("fCZfY",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e=[]){if(this.canCompress=e=>this.compressionRules.some(t=>t.canCompress(e)),this.compress=e=>{let t=this.createGroups(e);return t.reduce((e,t)=>{let s=this.compressGroup(t);return e.concat(s)},[])},this.createGroups=e=>e.reduce((e,t)=>{let s;let r=this.compressionRules.find(e=>e.canCompress(t));if(r){let e=(0,a("25Azf").buildActionFields)(t,t.eventType);s=(0,a("7CSD8").omit)(t,Object.keys(e))}let i=e.find(e=>r===e.compressor&&(0,a("7CSD8").equals)(s,e.contextFields));return i?i.events.push(t):e.push({contextFields:s,compressor:r,events:[t]}),e},[]),this.compressGroup=e=>{if(!e.compressor)return e.events;try{let t=e.compressor.compress(e.events);return t.map(t=>({...t,...e.contextFields}))}catch(t){return console.warn(`Failed to compress some analytics events. Error: ${t.message}. Sending ${e.events.length} uncompressed events instead`),e.events}},!Array.isArray(e))throw Error("Event compressors must be constructed with an array of CompressionRules");if(!e.every(e=>e instanceof a("abpf4").CompressionRule))throw Error("Event compressors can only be constructed with instances of CompressionRule");this.compressionRules=e}}}),n("6UZcF",function(t,s){var r,i;e(t.exports,"StopLowPriorityEventDelayReason",()=>r),(i=r||(r={})).TIMEOUT="timeout",i.MANUAL="manual"}),n("kVbF6",function(s,r){e(s.exports,"default",()=>n);var i=a("dFBS3");class n{constructor(e){this.sendEvents=async(e,t)=>{let s=this.resilienceQueue.getGlobalRetryCount(),r=this.metrics.getMetricsPayload(),i={...r,httpRetryCount:s};for(let e in i)0===i[e]&&delete i[e];let n=await this.attachXIDs(e),o=new Date().toISOString(),l=n.map(e=>(e.msg.sentAt=o,e.msg));try{let e=await (0,a("e1MV9").sendEvents)({url:this.gasv3BatchUrl,batch:{batch:l,sentAt:o,metadata:i},timeout:this.options.requestTimeout});this.metrics.subtractFromMetrics(r),t(null,e)}catch(e){t(e,null)}},this.options={...e,requestTimeout:e.requestTimeout||a("ajscq").DEFAULT_REQUEST_TIMEOUT,retryQueueOptions:e.retryQueueOptions||{},logger:e.logger||console,disableCookiePersistence:e.disableCookiePersistence||!1},this.user=new(a("jq5wq")).default(this.options?.disableCookiePersistence),this.xidPromiseCallback=e.xidPromiseGetter(),this.gasv3BatchUrl=`${e.apiHostProtocol}://${e.apiHost}/batch`,this.metrics=(0,a("da9U4").default)(),this.resilienceQueue=(0,a("iqxBY").default)(e.retryQueuePrefix,e.product,this.options.retryQueueOptions,this.options.logger),this.resilienceQueue.start(this.sendEvents)}getUser(){return this.user}async track(e,t,s,r){let i=this.buildBaseEvent(s,a("ajFzF").SegmentEventTypes.TRACK,t),n={...i,type:a("ajFzF").SegmentEventTypes.TRACK,properties:(0,a("k2lCJ").prepareEventProperties)(t),event:e},o={...n,messageId:this.createMessageId()},l=this.packageEvent(o);await this.resilienceQueue.addItem(l),r&&r()}async page(e,t,s,r){let i=this.buildBaseEvent(s,a("ajFzF").SegmentEventTypes.PAGE,t),n={...i,type:a("ajFzF").SegmentEventTypes.PAGE,properties:(0,a("k2lCJ").prepareEventProperties)(t),name:e},o={...n,messageId:this.createMessageId()},l=this.packageEvent(o);await this.resilienceQueue.addItem(l),r&&r()}async identify(e,t,s,r){let i=this.buildBaseEvent(s,a("ajFzF").SegmentEventTypes.IDENTIFY,t),n={...i,type:a("ajFzF").SegmentEventTypes.IDENTIFY,traits:(0,a("k2lCJ").prepareEventProperties)(t)},o={...n,messageId:this.createMessageId()},l=this.packageEvent(o);await this.resilienceQueue.addItem(l),r&&r()}buildBaseEvent(e,t,s){let r=(0,a("k2lCJ").prepareEventProperties)(e),i=(0,a("k2lCJ").buildContext)(r);return{context:i,timestamp:new Date().toISOString(),type:t,userId:this.user.getUserId(),anonymousId:s.anonymousId||this.user.getAnonymousId()}}createMessageId(){return`ajs-${t(i)()}`}packageEvent(e){let{apiHost:t,apiHostProtocol:s}=this.options;return{headers:{"Content-Type":"text/plain"},msg:e,url:`${s}://${t}/${e.type.charAt(0)}`}}async attachXIDs(e){return this.xidPromiseCallback?(0,a("dW7Om").attachXidToMultipleEvents)(e,this.xidPromiseCallback):Promise.resolve(e)}}}),n("iqxBY",function(t,s){e(t.exports,"default",()=>r);var r=(e,t,s,r)=>new(a("7wGwj")).default(e,t,s||{},r)}),n("7wGwj",function(t,s){e(t.exports,"default",()=>n);let r={backoffFactor:0,backoffJitterPercentage:0,flushWaitMs:6e4,minRetryDelay:6e4,maxRetryDelay:6e4},i={backoffFactor:2,backoffJitterPercentage:.2,batchFlushSize:7,flushBeforeUnload:!1,flushWaitMs:500,maxAttempts:10,maxItems:1e3,maxRetryDelay:3e4,minRetryDelay:1e3};class n{constructor(e,t,s,i){this.queuePrefix=e,this.resilience=new(a("1jUQe")).default(t,{logger:i,maxAttempts:s?.maxAttempts,maxEventLimit:s?.maxItems}),this.options=this.buildOptions(s),this.scheduler=new(a("hfOwY")).default({...this.options,waitInterval:s?.flushBeforeUnload?0:this.options.flushWaitMs},this.scheduleCallback.bind(this)),this.longPollingScheduler=new(a("hfOwY")).default({...r,waitInterval:r.flushWaitMs},this.scheduleLongCallBack.bind(this)),this.metricsCollector=(0,a("da9U4").default)(),this.networkStatus=new(a("7jsqH")).default(e=>{e===a("gTidA").NetworkStatusEnum.OFFLINE?this.scheduler.stop():this.checkEventCountAndReschedule()})}start(e){this.batchFlushCallback=e,this.longPollingScheduler.schedule()}stop(){this.scheduler.stop(),this.longPollingScheduler.stop()}async addItem(e){let t=JSON.parse(JSON.stringify(e)),{numberOfEvictedItems:s}=await this.resilience.addItem(t,{},a("bKakw").GuardPolicy.EVICT);this.scheduler.schedule(),this.metricsCollector.addToEventCount(),s>0&&this.metricsCollector.addToItemsDiscardedByOverflowCounter(s)}getGlobalRetryCount(){return this.scheduler.getFailureCount()}async scheduleCallback(e){if(this.networkStatus.getNetworkStatus()===a("gTidA").NetworkStatusEnum.OFFLINE){e(a("cXMXc").DoneState.NOOP);return}try{let t=await this.resilience.processItems(this.flush.bind(this),this.options.batchFlushSize);e(t)}catch(t){if(t.name===a("5SoTQ").CallbackProcessingErrorName){e(a("cXMXc").DoneState.ERROR);return}}finally{await this.checkEventCountAndReschedule()}}async checkEventCountAndReschedule(){let e=await this.resilience.getItemCount();e>0&&this.scheduler.schedule({immediate:e>=this.options.batchFlushSize})}async scheduleLongCallBack(e){let t=(0,a("jLlWs").default)(this.queuePrefix);this.metricsCollector.addToPurgedQueuesMetrics(t);let s=await (0,a("hvScO").default)(this.queuePrefix,async e=>{let t=e.map(e=>({item:e.item,retryAttempts:e.attemptNumber,id:e.id})),{items:s}=await this.resilience.bulkAddItem(t,a("bKakw").GuardPolicy.IGNORE);return s.length===t.length?{status:"successful"}:{status:"partial",acceptedItemIds:s.map(e=>e.id)}});this.metricsCollector.addToReclaimMetrics(s),await this.checkEventCountAndReschedule(),e(a("cXMXc").DoneState.SUCCESS),this.longPollingScheduler.schedule()}flush(e,t){this.metricsCollector.setResilienceMechanism(this.resilience.storeType());let{batchFlushCallback:s}=this;if(!s)throw Error("batchFlushCallback has not been set. Call PullBatchableQueue#start first.");return new Promise((r,i)=>{if(e.length<=0){r(a("cXMXc").DoneState.NOOP);return}let n=e.map(e=>{let t=e.item;return e.retryAttempts>0&&t.msg&&(t.msg._metadata||(t.msg._metadata={}),t.msg._metadata.failedAttempts=e.retryAttempts),t});s(n,e=>{e?(t.numberOfDeletedItems>0&&this.metricsCollector.addToItemsDiscardedByRetryCounter(t.numberOfDeletedItems),i(e)):r(a("cXMXc").DoneState.SUCCESS)})})}buildOptions(e){return{backoffFactor:e?.backoffFactor||i.backoffFactor,backoffJitterPercentage:e?.backoffJitterPercentage!==void 0?e.backoffJitterPercentage:i.backoffJitterPercentage,batchFlushSize:e?.batchFlushSize||i.batchFlushSize,flushBeforeUnload:e?.flushBeforeUnload||i.flushBeforeUnload,flushWaitMs:e?.flushWaitMs||i.flushWaitMs,maxItems:e?.maxItems||i.maxItems,maxAttempts:e?.maxAttempts||i.maxAttempts,maxRetryDelay:e?.maxRetryDelay||i.maxRetryDelay,minRetryDelay:e?.minRetryDelay||i.minRetryDelay}}}}),n("jLlWs",function(t,s){e(t.exports,"default",()=>i);let r=Object.values(a("2vFy6").LocalStorageKeySuffix);var i=e=>{if("string"!=typeof e||0===e.length)return 0;try{let t=Object.keys(localStorage).filter(t=>t&&t.startsWith(`${e}.`)||!1).map(e=>e.split(".")).filter(e=>3===e.length&&r.includes(e[2])).reduce((e,t)=>{let[,s,r]=t;return void 0===e[s]&&(e[s]={}),e[s][r]=!0,e},{}),s=Object.keys(t).filter(e=>!0!==t[e][a("2vFy6").LocalStorageKeySuffix.ACK]);return s.forEach(t=>{let{queue:s,inProgress:r,reclaimStart:i,reclaimEnd:n}=(0,a("cEQrv").createLocalStorageKeys)(e,t);localStorage.removeItem(r),localStorage.removeItem(s),localStorage.removeItem(i),localStorage.removeItem(n)}),s.length}catch(e){}return 0}}),n("2vFy6",function(t,s){var r,i,a,n;e(t.exports,"LocalStorageKeySuffix",()=>r),e(t.exports,"Timers",()=>i),(a=r||(r={})).IN_PROGRESS="inProgress",a.QUEUE="queue",a.RECLAIM_START="reclaimStart",a.RECLAIM_END="reclaimEnd",a.ACK="ack",(n=i||(i={}))[n.RECLAIM_TIMEOUT=1e4]="RECLAIM_TIMEOUT",n[n.RECLAIM_WAIT=500]="RECLAIM_WAIT",n[n.RECLAIM_WAIT_THRESHOLD=2e3]="RECLAIM_WAIT_THRESHOLD"}),n("cEQrv",function(t,s){e(t.exports,"createLocalStorageKeys",()=>r);let r=(e,t)=>({[a("2vFy6").LocalStorageKeySuffix.ACK]:`${e}.${t}.${a("2vFy6").LocalStorageKeySuffix.ACK}`,[a("2vFy6").LocalStorageKeySuffix.QUEUE]:`${e}.${t}.${a("2vFy6").LocalStorageKeySuffix.QUEUE}`,[a("2vFy6").LocalStorageKeySuffix.IN_PROGRESS]:`${e}.${t}.${a("2vFy6").LocalStorageKeySuffix.IN_PROGRESS}`,[a("2vFy6").LocalStorageKeySuffix.RECLAIM_START]:`${e}.${t}.${a("2vFy6").LocalStorageKeySuffix.RECLAIM_START}`,[a("2vFy6").LocalStorageKeySuffix.RECLAIM_END]:`${e}.${t}.${a("2vFy6").LocalStorageKeySuffix.RECLAIM_END}`})}),n("hvScO",function(s,r){e(s.exports,"default",()=>d);var i=a("dFBS3");let n=e=>new Promise(t=>{setTimeout(t,e)}),o=e=>{try{return Object.keys(localStorage).filter(t=>t.startsWith(e)).map(e=>e.split(".")).filter(t=>{if(3===t.length&&t[0]===e&&t[2]===a("2vFy6").LocalStorageKeySuffix.ACK)try{let e=localStorage.getItem(t.join("."));if(e){let t=parseInt(e);return a("2vFy6").Timers.RECLAIM_TIMEOUT+t<Date.now()}}catch(e){}return!1}).map(e=>e[1])}catch(e){}return[]},l=async(e,t)=>{let{ack:s,reclaimStart:r,reclaimEnd:i}=e.storageKeys,o=Date.now();if(localStorage.setItem(r,e.reclaimProcessId),localStorage.setItem(s,o.toString()),await n(a("2vFy6").Timers.RECLAIM_WAIT),Date.now()>o+a("2vFy6").Timers.RECLAIM_WAIT_THRESHOLD||localStorage.getItem(r)!==e.reclaimProcessId)throw Error("Took to long to callback, reclaim abandonded. After reclaimStart.");if(localStorage.setItem(i,e.reclaimProcessId),await n(a("2vFy6").Timers.RECLAIM_WAIT),Date.now()>o+a("2vFy6").Timers.RECLAIM_WAIT_THRESHOLD||localStorage.getItem(r)!==e.reclaimProcessId||localStorage.getItem(i)!==e.reclaimProcessId)throw Error("Took to long to callback, reclaim abandonded. After reclaimEnd.");return c(e,t)},c=async(e,t)=>{let{queue:s,inProgress:r}=e.storageKeys,i=JSON.parse(localStorage.getItem(s)||"[]"),a=JSON.parse(localStorage.getItem(r)||"{}"),n=Object.entries(a).map(([e,t])=>{let s={...t,attemptNumber:t.attemptNumber+1,id:e};return s}),o=[...i,...n];if(o.length>0){let i=await t(o);if("successful"===i.status)u(e.storageKeys);else if("partial"===i.status){let e=o.filter(e=>!i.acceptedItemIds.includes(e.id));return localStorage.removeItem(r),localStorage.setItem(s,JSON.stringify(e)),{fullReclaim:!1}}}else u(e.storageKeys);return{fullReclaim:!0}},u=e=>{localStorage.removeItem(e.queue),localStorage.removeItem(e.inProgress),localStorage.removeItem(e.reclaimEnd),localStorage.removeItem(e.reclaimStart),localStorage.removeItem(e.ack)};var d=async(e,s)=>{if("string"!=typeof e||0===e.length)return{fullReclaims:0,partialReclaims:0,failedReclaims:0};let r=t(i)(),n=o(e),c=n.map(t=>l({queuePrefix:e,reclaimProcessId:r,storageKeys:(0,a("cEQrv").createLocalStorageKeys)(e,t)},s)),u=await Promise.allSettled(c),d=u.filter(e=>"rejected"===e.status),h=u.filter(e=>"fulfilled"===e.status).map(e=>e.value),p=h.filter(e=>e.fullReclaim),g=h.filter(e=>!e.fullReclaim);return{failedReclaims:d.length,partialReclaims:g.length,fullReclaims:p.length}}}),n("5SoTQ",function(t,s){e(t.exports,"CallbackProcessingErrorName",()=>r),e(t.exports,"default",()=>i);let r="CallbackProcessingError";class i extends Error{constructor(e){let t=e&&"object"==typeof e&&"toString"in e&&"function"==typeof e.toString&&e.toString(),s=t||"string"==typeof e&&e||"Argument passed to CallbackProcessingError was not an Error or string.";super(`Error thrown while processing events in callback: ${s}`),Object.setPrototypeOf(this,i.prototype),this.name=r}}}),n("1jUQe",function(t,s){e(t.exports,"default",()=>r);var r=a("3GfxO").default}),n("3GfxO",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t={}){if(this.namespace=e,this.options=(0,a("cNl0a").createOptionsWithDefaults)(t),!e||0===e.length||"string"!=typeof e)throw Error("Invalid namespace provided");this.resilience=this.getResilienceMechanism(e,t)}getResilienceMechanism(e,t){if(!t.useMemory)try{return new(a("5UH0i")).default(e,t)}catch(e){e instanceof a("lisrX").default||t.logger?.warn("Attempted to create IndexedDbResilience but failed. Using memory instead.")}return new(a("hFHae")).default(this.namespace,t)}addItem(e,t,s=a("bKakw").GuardPolicy.ABANDON){return this.runOrFailOver(()=>this.resilience.addItem(e,t,s))}bulkAddItem(e,t=a("bKakw").GuardPolicy.ABANDON){return this.runOrFailOver(()=>this.resilience.bulkAddItem(e,t))}getItems(e){return this.runOrFailOver(()=>this.resilience.getItems(e))}deleteItems(e){return this.runOrFailOver(()=>this.resilience.deleteItems(e))}getItemCount(){return this.runOrFailOver(()=>this.resilience.getItemCount())}processItems(e,t){return this.runOrFailOver(()=>this.resilience.processItems(e,t))}storeType(){return this.resilience.storeType()}async runOrFailOver(e){try{return await e()}catch(t){if((0,a("aYvBI").shouldIgnoreResilienceDbError)(t))throw t;return this.resilience.storeType()===a("bKakw").StoreType.INDEXEDDB&&await this.failOver(),e()}}async failOver(){let e=this.resilience,t=new(a("hFHae")).default(this.namespace,this.options);this.resilience=t;try{let{items:s}=await e.getItems(this.options.maxEventLimit);if(s.length>0){let r=await t.bulkAddItemWrapperType(s,a("bKakw").GuardPolicy.IGNORE),i=r.items.map(e=>e.id);await e.deleteItems(i)}}catch(e){this.options.logger.warn("Unexpected error from ResilienceDb, switching to MemoryDb")}}}}),n("bKakw",function(t,s){var r,i,a,n;e(t.exports,"NAMESPACE_AND_TIME_ADDED_INDEX",()=>o),e(t.exports,"RESILIENCE_DB_NAME",()=>l),e(t.exports,"RESILIENCE_STORE_NAME",()=>c),e(t.exports,"TIME_TO_PROCESS_AFTER_INDEX",()=>u),e(t.exports,"TIME_ADDED_INDEX",()=>d),e(t.exports,"RETRY_INDEX",()=>h),e(t.exports,"INDEXEDDB_TIMEOUT",()=>p),e(t.exports,"StoreType",()=>r),e(t.exports,"GuardPolicy",()=>i);let o="namespace-timeAdded",l="analytics-web-client",c="analytics-resilience",u="timeToBeProcessedAfter",d="timeAdded",h="retryAttempts",p=15e3;(a=r||(r={})).INDEXEDDB="indexeddb",a.MEMORY="memory",(n=i||(i={})).IGNORE="ignore",n.ABANDON="abandon",n.EVICT="evict"}),n("lisrX",function(t,s){e(t.exports,"default",()=>r);class r extends Error{constructor(){super("window.indexeddb is undefined."),Object.setPrototypeOf(this,r.prototype),this.name="NoIndexedDbError"}}}),n("aYvBI",function(t,s){e(t.exports,"shouldIgnoreResilienceDbError",()=>r);let r=e=>!!e&&"object"==typeof e&&"name"in e&&"string"==typeof e.name&&(e.name===a("kIUNI").AbandonWriteErrorName||e.name===a("5SoTQ").CallbackProcessingErrorName||e.name===a("6W4Fx").InvalidPolicyErrorName)}),n("kIUNI",function(t,s){e(t.exports,"AbandonWriteErrorName",()=>r),e(t.exports,"default",()=>i);let r="AbandonWriteError";class i extends Error{constructor(e){super(`Event Limit reached. Abandoning write to: ${e}`),Object.setPrototypeOf(this,i.prototype),this.name=r}}}),n("6W4Fx",function(t,s){e(t.exports,"InvalidPolicyErrorName",()=>r),e(t.exports,"default",()=>i);let r="InvalidPolicyError";class i extends Error{constructor(e,t){super(`Method '${t}' cannot be called with policy '${e}'.`),this.name=r}}}),n("5UH0i",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t={}){if(this.startDB=async()=>new Promise(async(e,t)=>{if("undefined"!=typeof window){let s=window.setTimeout(()=>{this.logger.warn("IndexedDB timed out."),t(new(a("lisrX")).default)},a("bKakw").INDEXEDDB_TIMEOUT),r=window.indexedDB.open(a("bKakw").RESILIENCE_DB_NAME,1);r.onupgradeneeded=e=>{if(0!==e.oldVersion)throw Error("We cannot upgrade the database. Do not do this.");let t=r.result,s=t.createObjectStore(a("bKakw").RESILIENCE_STORE_NAME,{keyPath:"id"});s.createIndex(a("bKakw").TIME_TO_PROCESS_AFTER_INDEX,a("bKakw").TIME_TO_PROCESS_AFTER_INDEX,{unique:!1}),s.createIndex(a("bKakw").RETRY_INDEX,a("bKakw").RETRY_INDEX,{unique:!1}),s.createIndex(a("bKakw").TIME_ADDED_INDEX,a("bKakw").TIME_ADDED_INDEX,{unique:!1}),s.createIndex(a("bKakw").NAMESPACE_AND_TIME_ADDED_INDEX,["namespace","timeAdded"],{unique:!1})};try{return await (0,a("cNl0a").requestToPromise)(r),e(r.result)}catch(e){this.logger.warn("IndexedDB failed to initialise.",e),t(new(a("lisrX")).default)}finally{window.clearTimeout(s)}}else this.logger.warn("IndexedDB failed to initialise. No 'window' object."),t(new(a("lisrX")).default)}),this.addItem=async(e,t={},s=a("bKakw").GuardPolicy.ABANDON)=>{let{logger:r,namespace:i}=this,n=(0,a("cNl0a").convertToItemWrapper)(e,i,t),{objectStore:o}=await this.getObjectStoreAndTransaction("readwrite");if(s===a("bKakw").GuardPolicy.IGNORE)throw new(a("6W4Fx")).default(s,"IndexedDbConnector#addItem");try{if(!n.namespace||0===n.namespace.length||"string"!=typeof n.namespace)throw Error("Namespace not specified");let e=await this.globalEventLimitGuard.insertItems(o,[n],s);if(1===e.items.length)return{item:e.items[0],numberOfEvictedItems:e.numberOfEvictedItems};throw Error(`Incorrect number of items added. Expected: 1, got: ${e.items.length}`)}catch(e){if((0,a("aYvBI").shouldIgnoreResilienceDbError)(e))throw e;throw r.log("Failed to add item to table",e),Error("Request to add item to table failed")}},this.bulkAddItem=async(e,t=a("bKakw").GuardPolicy.ABANDON)=>{let{logger:s,namespace:r}=this,i=e.map(({item:e,...t})=>(0,a("cNl0a").convertToItemWrapper)(e,r,t)),{objectStore:n}=await this.getObjectStoreAndTransaction("readwrite");try{return await this.globalEventLimitGuard.insertItems(n,i,t)}catch(e){if((0,a("aYvBI").shouldIgnoreResilienceDbError)(e))throw e;throw s.log("Failed to add item to table",e),Error("Request to add item to table failed")}},this.getItems=async(e=a("k2t57").GET_ITEM_COUNT)=>{let t=e>0?e:a("k2t57").GET_ITEM_COUNT,{logger:s}=this,r=this.options.maxAttempts,{transaction:i,objectStore:n}=await this.getObjectStoreAndTransaction("readwrite"),o=n.index(a("bKakw").TIME_TO_PROCESS_AFTER_INDEX),l=IDBKeyRange.upperBound(Date.now()),c=o.openCursor(l),u=await new Promise(async(e,i)=>{let n=[],o=0;c.onerror=e=>{s.error("Failed to open cursor:",e),i("Failed to open cursor")},c.onsuccess=i=>{let l=i.target.result;if(l){let i={...l.value};n.push(i);let c=l.value;if(c.retryAttempts+=1,c.timeToBeProcessedAfter=Date.now()+a("k2t57").VISIBILITY_TIMEOUT,c.retryAttempts>=r){++o;let e=l.delete();(0,a("cNl0a").monitorErrorsOnRequest)(e,s)}else{let e=l.update(c);(0,a("cNl0a").monitorErrorsOnRequest)(e,s)}n.length<t?l.continue():e({items:n,numberOfDeletedItems:o})}else e({items:n,numberOfDeletedItems:o})}});return await (0,a("cNl0a").commitTransaction)(i,this.logger),u},this.deleteItems=async e=>{let{transaction:t,objectStore:s}=await this.getObjectStoreAndTransaction("readwrite");try{let r=e.map(e=>this.deleteItem(s,e));await (0,a("cNl0a").commitTransaction)(t,this.logger),await Promise.all(r)}catch(e){throw this.logger.warn("Failed to delete items from indexeddb.",e),e}},this.getItemCount=async()=>{let{transaction:e,objectStore:t}=await this.getObjectStoreAndTransaction("readonly"),s=t.index(a("bKakw").TIME_TO_PROCESS_AFTER_INDEX),r=IDBKeyRange.upperBound(Date.now()),i=s.count(r),n=await (0,a("cNl0a").requestToPromise)(i);return await (0,a("cNl0a").commitTransaction)(e,this.logger),n.target.result},this.processItems=async(e,t=a("k2t57").GET_ITEM_COUNT)=>{let{items:s,...r}=await this.getItems(t);try{let t=await e(s,r),i=s.map(e=>e.id);return await this.deleteItems(i),t}catch(e){throw new(a("5SoTQ")).default(e)}},this.deleteItem=async(e,t)=>{let{logger:s}=this;try{await (0,a("cNl0a").requestToPromise)(e.delete(t))}catch(e){throw s.error("Failed to delete item:",t,e),e}},this.getObjectStoreAndTransaction=async e=>{let t=(await this.db).transaction(a("bKakw").RESILIENCE_STORE_NAME,e),s=t.objectStore(a("bKakw").RESILIENCE_STORE_NAME);return{transaction:t,objectStore:s}},this.options=(0,a("cNl0a").createOptionsWithDefaults)(t),this.namespace=e,this.logger=this.options.logger,!window.indexedDB)throw new(a("lisrX")).default;this.db=this.startDB(),this.db.catch(()=>{}),this.globalEventLimitGuard=new(a("aZ2Py")).default(this.options.maxEventLimit,this.namespace,this.logger,this.deleteItem)}storeType(){return a("bKakw").StoreType.INDEXEDDB}}}),n("k2t57",function(t,s){e(t.exports,"GET_ITEM_COUNT",()=>r),e(t.exports,"VISIBILITY_TIMEOUT",()=>i),e(t.exports,"MAX_ATTEMPTS",()=>a),e(t.exports,"EVENT_COUNT_LIMIT",()=>n);let r=7,i=6e4,a=10,n=5e3}),n("aZ2Py",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t,s,r){if(this.deleteOldestNEvents=async(e,t)=>{let s=e.index(a("bKakw").NAMESPACE_AND_TIME_ADDED_INDEX),r=IDBKeyRange.bound([this.namespace,0],[this.namespace,Date.now()]),i=s.getAllKeys(r,t),n=await (0,a("cNl0a").requestToPromise)(i),o=n?.target?.result;if(o&&Array.isArray(o)&&o.length>0)try{let t=o.map(t=>this.deleteItemHandler(e,t));await Promise.all(t)}catch(e){throw this.logger.warn("Failed to delete items from indexeddb.",e),e}},e>0)this.eventLimit=e;else throw Error("Event Limit has to be set higher than 1");this.namespace=t,this.logger=s,this.deleteItemHandler=r}async insertItems(e,t,s=a("bKakw").GuardPolicy.ABANDON){let r=[...t],i=0;switch(s){case a("bKakw").GuardPolicy.ABANDON:await this.throwIfNotEnoughSpace(e,t.length);break;case a("bKakw").GuardPolicy.EVICT:i=await this.evictIfNotEnoughSpace(e,t.length);break;case a("bKakw").GuardPolicy.IGNORE:await this.calculateHowManyEventsWeCanAdd(e,r)}let n=r.map(t=>(0,a("cNl0a").requestToPromise)(e.add(t)));return await Promise.all(n),await (0,a("cNl0a").commitTransaction)(e.transaction,this.logger),{items:r,numberOfEvictedItems:i}}async throwIfNotEnoughSpace(e,t){let s=await this.calculateFreeSpace(e);if(s<t)throw new(a("kIUNI")).default(`Not enough space in IndexedDb. Needed ${t} but only had ${s}`)}async evictIfNotEnoughSpace(e,t){let s=await this.calculateFreeSpace(e);if(s<t){let r=t-s;return await this.deleteOldestNEvents(e,r),r}return 0}async calculateHowManyEventsWeCanAdd(e,t){let s=await this.calculateFreeSpace(e);if(s<t.length){let e=t.length-s,r=t.length-e;t.splice(r,e)}}async calculateFreeSpace(e){let t=await this.getCountofEventsInObjectStore(e);return this.eventLimit-t}async getCountofEventsInObjectStore(e){let t=e.index(a("bKakw").NAMESPACE_AND_TIME_ADDED_INDEX),s=IDBKeyRange.bound([this.namespace,0],[this.namespace,Date.now()]),r=t.count(s),i=await (0,a("cNl0a").requestToPromise)(r);return i.target.result}}}),n("cNl0a",function(s,r){e(s.exports,"convertToItemWrapper",()=>n),e(s.exports,"createOptionsWithDefaults",()=>o),e(s.exports,"requestToPromise",()=>l),e(s.exports,"commitTransaction",()=>u),e(s.exports,"monitorErrorsOnRequest",()=>d);var i=a("dFBS3");let n=(e,s,{id:r,retryAttempts:a,timeToProcessOffset:n})=>({item:e,id:r||t(i)(),retryAttempts:a||0,timeToBeProcessedAfter:Date.now()+(n||0),namespace:s,timeAdded:Date.now()}),o=e=>({logger:e.logger||console,useMemory:e.useMemory||!1,maxAttempts:e.maxAttempts||a("k2t57").MAX_ATTEMPTS,maxEventLimit:e.maxEventLimit||a("k2t57").EVENT_COUNT_LIMIT}),l=e=>new Promise((t,s)=>{e.onsuccess=e=>{t(e)},e.onerror=e=>{s(e)}}),c=e=>new Promise((t,s)=>{e.oncomplete=()=>{t()},e.onerror=e=>{s(e)},e.onabort=e=>{s(e)}}),u=(e,t)=>{try{"function"==typeof e.commit&&e.commit()}catch(e){throw t.error("Failed to force commit transaction:",e),e}return c(e)},d=(e,t)=>{e.onerror=e=>{t.warn("Error thrown from request:",e)}}}),n("hFHae",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t={}){this.namespace=e,this.memoryStore=[],this.options=(0,a("cNl0a").createOptionsWithDefaults)(t),this.globalEventLimitGuard=new(a("lv9C9")).default(this.options.maxEventLimit,{addItems:this.addItems.bind(this),getItemCount:this.getItemCount.bind(this),evictEventsIfNeeded:this.evictEventsIfNeeded.bind(this)})}async addItem(e,t={},s=a("bKakw").GuardPolicy.ABANDON){if(s===a("bKakw").GuardPolicy.IGNORE)throw new(a("6W4Fx")).default(s,"IndexedDbConnector#addItem");let r=(0,a("cNl0a").convertToItemWrapper)(e,this.namespace,t),i=await this.globalEventLimitGuard.insertItemsToMemoryStore([r],s);return Promise.resolve({item:i.items[0],numberOfEvictedItems:i.numberOfEvictedItems})}bulkAddItem(e,t=a("bKakw").GuardPolicy.ABANDON){let s=e.map(({item:e,...t})=>(0,a("cNl0a").convertToItemWrapper)(e,this.namespace,t));return this.bulkAddItemWrapperType(s,t)}bulkAddItemWrapperType(e,t=a("bKakw").GuardPolicy.ABANDON){return Promise.resolve(this.globalEventLimitGuard.insertItemsToMemoryStore(e,t))}getItems(e=a("k2t57").GET_ITEM_COUNT){return Promise.resolve(this.synchronousGetItems(e))}synchronousGetItems(e=a("k2t57").GET_ITEM_COUNT){let t=e>0?e:a("k2t57").GET_ITEM_COUNT,s=Date.now(),r=[],i=[];for(let e of this.memoryStore)if(e.timeToBeProcessedAfter<=s&&(r.push({...e}),e.timeToBeProcessedAfter+=a("k2t57").VISIBILITY_TIMEOUT,e.retryAttempts+=1,e.retryAttempts>=this.options.maxAttempts&&i.push(e)),r.length>=t)break;return i.forEach(e=>{let t=this.memoryStore.indexOf(e);this.memoryStore.splice(t,1)}),{items:r,numberOfDeletedItems:i.length}}deleteItems(e){return this.memoryStore=this.memoryStore.filter(t=>!e.includes(t.id)),Promise.resolve(void 0)}getItemCount(){let e=Date.now(),t=this.memoryStore.filter(t=>t.timeToBeProcessedAfter<=e).length;return Promise.resolve(t)}async processItems(e,t){let{items:s,...r}=this.synchronousGetItems(t),i=s.map(e=>e.id);try{let t=await e(s,r);return await this.deleteItems(i),t}catch(e){throw new(a("5SoTQ")).default(e)}}storeType(){return a("bKakw").StoreType.MEMORY}addItems(e){this.memoryStore.push(...e),this.memoryStore.sort(function(e,t){return e.timeAdded-t.timeAdded})}evictEventsIfNeeded(e){let t=this.memoryStore.length;if(t>e){let s=t-e;return this.memoryStore.splice(0,s),s}return 0}}}),n("lv9C9",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t){if(this.insertItemsToMemoryStore=(e,t)=>{switch(t){case a("bKakw").GuardPolicy.ABANDON:return this.handleAbandonIfLimitWillExceedPolicy(e);case a("bKakw").GuardPolicy.EVICT:return Promise.resolve(this.handleEvictOldestIfLimitExceededPolicy(e));case a("bKakw").GuardPolicy.IGNORE:return this.handleAddAsManyAsPossible(e)}},e>0)this.eventLimit=e;else throw Error("Event Limit has to be set higher than 1");this.memoryItemHandlers=t}async handleAbandonIfLimitWillExceedPolicy(e){let t=await this.memoryItemHandlers.getItemCount();if(t+e.length>this.eventLimit)throw new(a("kIUNI")).default(a("bKakw").StoreType.MEMORY);return this.memoryItemHandlers.addItems(e),{items:e,numberOfEvictedItems:0}}handleEvictOldestIfLimitExceededPolicy(e){this.memoryItemHandlers.addItems(e);let t=this.memoryItemHandlers.evictEventsIfNeeded(this.eventLimit);return{items:e,numberOfEvictedItems:t}}async handleAddAsManyAsPossible(e){let t=this.eventLimit-await this.memoryItemHandlers.getItemCount(),s=t>e.length?e:e.slice(0,t);return this.memoryItemHandlers.addItems(s),{items:s,numberOfEvictedItems:0}}}}),n("da9U4",function(t,s){e(t.exports,"default",()=>n);class r{addToItemsDiscardedByRetryCounter(e=1){this.itemsDiscardedByRetry+=e}addToEventCount(){this.eventCount++}addToItemsDiscardedByOverflowCounter(e=1){this.itemsDiscardedByOverflow+=e}setResilienceMechanism(e){this.resilienceMechanism=e}addToReclaimMetrics(e){this.localstorageNumberOfFullReclaims+=e.fullReclaims,this.localstorageNumberOfPartialReclaims+=e.partialReclaims,this.localstorageNumberOfFailedReclaims+=e.failedReclaims}addToPurgedQueuesMetrics(e){this.localstorageNumberOfQueuesPurged+=e}subtractFromMetrics(e){this.itemsDiscardedByRetry=this.subtractFromCount(this.itemsDiscardedByRetry,e.itemsDiscardedByRetry),this.eventCount=this.subtractFromCount(this.eventCount,e.eventCount),this.itemsDiscardedByOverflow=this.subtractFromCount(this.itemsDiscardedByOverflow,e.itemsDiscardedByOverflow),this.localstorageNumberOfFullReclaims=this.subtractFromCount(this.localstorageNumberOfFullReclaims,e.fullReclaims),this.localstorageNumberOfPartialReclaims=this.subtractFromCount(this.localstorageNumberOfPartialReclaims,e.partialReclaims),this.localstorageNumberOfFailedReclaims=this.subtractFromCount(this.localstorageNumberOfFailedReclaims,e.failedReclaims),this.localstorageNumberOfQueuesPurged=this.subtractFromCount(this.localstorageNumberOfQueuesPurged,e.localstorageQueuesPurged)}subtractFromCount(e,t){return Math.max(e-(t||0),0)}getMetricsPayload(){return{itemsDiscardedByRetry:this.itemsDiscardedByRetry,eventCount:this.eventCount,itemsDiscardedByOverflow:this.itemsDiscardedByOverflow,resilienceMechanism:this.resilienceMechanism,localstorageQueuesPurged:this.localstorageNumberOfQueuesPurged,fullReclaims:this.localstorageNumberOfFullReclaims,partialReclaims:this.localstorageNumberOfPartialReclaims,failedReclaims:this.localstorageNumberOfFailedReclaims}}constructor(){this.itemsDiscardedByRetry=0,this.eventCount=0,this.itemsDiscardedByOverflow=0,this.resilienceMechanism=a("gTidA").ResilienceMechanism.INDEXEDDB,this.localstorageNumberOfQueuesPurged=0,this.localstorageNumberOfFullReclaims=0,this.localstorageNumberOfPartialReclaims=0,this.localstorageNumberOfFailedReclaims=0}}let i=null;var n=()=>(i||(i=new r),i)}),n("gTidA",function(t,s){var r,i,a,n;e(t.exports,"ResilienceMechanism",()=>r),e(t.exports,"NetworkStatusEnum",()=>i),(a=r||(r={})).INDEXEDDB="indexeddb",a.MEMORY="memory",(n=i||(i={}))[n.ONLINE=0]="ONLINE",n[n.OFFLINE=1]="OFFLINE"}),n("7jsqH",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e){"undefined"!=typeof window&&(window.addEventListener("offline",()=>e(a("gTidA").NetworkStatusEnum.OFFLINE)),window.addEventListener("online",()=>e(a("gTidA").NetworkStatusEnum.ONLINE)))}getNetworkStatus(){return window.navigator.onLine?a("gTidA").NetworkStatusEnum.ONLINE:a("gTidA").NetworkStatusEnum.OFFLINE}}}),n("hfOwY",function(t,s){var r,i;e(t.exports,"default",()=>o);let n={minRetryDelay:1e3,maxRetryDelay:3e4,backoffFactor:2,backoffJitterPercentage:0,waitInterval:500,callbackTimeoutPeriod:5e3};(i=r||(r={}))[i.NONE=0]="NONE",i[i.IMMEDIATE=1]="IMMEDIATE",i[i.WAIT=2]="WAIT";class o{constructor(e,t){this.schedule=({immediate:e}={immediate:!1})=>{"undefined"!=typeof window&&(this.operationInFlight?e?this.queuedSchedule=1:1!==this.queuedSchedule&&(this.queuedSchedule=2):(e||this.options.waitInterval<=0)&&0===this.failureCount?(this.clearTimeout(),this.run()):this.failureCount>0&&null===this.scheduledTimeout?this.scheduledTimeout=window.setTimeout(this.run,this.calculateBackoff()):null===this.scheduledTimeout&&(this.scheduledTimeout=window.setTimeout(this.run,this.options.waitInterval)))},this.stop=()=>{this.clearTimeout(),this.queuedSchedule=0},this.getFailureCount=()=>this.failureCount,this.getCallbackStatus=()=>this.callbackTimer.getCallbackStatus(),this.clearTimeout=()=>{"undefined"!=typeof window&&null!==this.scheduledTimeout&&(window.clearTimeout(this.scheduledTimeout),this.scheduledTimeout=null)},this.run=()=>{this.operationInFlight=!0,this.clearTimeout();try{this.callbackTimer.executeCallbackWithTimeout(this.callback,this.done,()=>this.done(a("cXMXc").DoneState.ERROR))}catch(e){this.done(e)}},this.done=e=>{this.operationInFlight=!1,e===a("cXMXc").DoneState.ERROR||this.callbackTimer.getCallbackStatus()===a("fcfRr").CallbackStatus.TIMED_OUT?(this.failureCount++,this.clearTimeout()):e===a("cXMXc").DoneState.SUCCESS&&(this.failureCount=0),this.processQueuedSchedule()},this.processQueuedSchedule=()=>{if(0!==this.queuedSchedule){let e=1===this.queuedSchedule;this.queuedSchedule=0,this.schedule({immediate:e})}else this.failureCount>0&&this.schedule()},this.calculateBackoff=()=>{let{minRetryDelay:e,maxRetryDelay:t,backoffFactor:s,backoffJitterPercentage:r}=this.options,i=e*s**this.failureCount;if(r){let e=Math.random(),t=Math.floor(e*r*i);5>Math.floor(10*e)?i-=t:i+=t}return Number(Math.min(i,t).toPrecision(1))},this.options={minRetryDelay:e.minRetryDelay||n.minRetryDelay,maxRetryDelay:e.maxRetryDelay||n.maxRetryDelay,backoffFactor:e.backoffFactor||n.backoffFactor,backoffJitterPercentage:e.backoffJitterPercentage||n.backoffJitterPercentage,waitInterval:void 0!==e.waitInterval?e.waitInterval:n.waitInterval,callbackTimeoutPeriod:e.callbackTimeoutPeriod||n.callbackTimeoutPeriod},this.scheduledTimeout=null,this.failureCount=0,this.callback=t,this.operationInFlight=!1,this.queuedSchedule=0,this.callbackTimer=new(a("fcfRr")).CallbackWithTimeout(this.options.callbackTimeoutPeriod)}}}),n("fcfRr",function(t,s){var r,i,a,n;e(t.exports,"CallbackStatus",()=>r),e(t.exports,"CallbackWithTimeout",()=>o),(a=r||(r={})).IDLE="idle",a.RUNNING="running",a.COMPLETED="completed",a.TIMED_OUT="timedOut",(n=i||(i={})).EXECUTE="execute",n.COMPLETE="complete",n.TIMEOUT="timeout";class o{constructor(e){if(this.timeoutHandle=void 0,this.callbackStatus="idle",e>0){this.timeoutPeriod=e;return}throw Error("CallbackWithTimeout requires timeout period higher than 0")}transitionCallbackStatus(e,t){switch(e){case"idle":case"timedOut":case"completed":"execute"===t&&(this.callbackStatus="running");break;case"running":switch(t){case"complete":this.callbackStatus="completed";break;case"timeout":this.callbackStatus="timedOut"}break;default:this.callbackStatus=e}}executeCallbackWithTimeout(e,t,s){"undefined"!=typeof window&&(this.transitionCallbackStatus(this.callbackStatus,"execute"),this.timeoutHandle=window.setTimeout(()=>{this.transitionCallbackStatus(this.callbackStatus,"timeout"),s()},this.timeoutPeriod),e(e=>{this.cancelTimeout(),"timedOut"!==this.getCallbackStatus()&&(this.transitionCallbackStatus(this.callbackStatus,"complete"),t(e))}))}getCallbackStatus(){return this.callbackStatus}cancelTimeout(){"undefined"!=typeof window&&this.timeoutPeriod>0&&this.timeoutHandle&&(window.clearTimeout(this.timeoutHandle),this.timeoutHandle=void 0)}}}),n("cXMXc",function(t,s){var r,i;e(t.exports,"DoneState",()=>r),(i=r||(r={}))[i.NOOP=0]="NOOP",i[i.SUCCESS=1]="SUCCESS",i[i.ERROR=2]="ERROR"}),n("dW7Om",function(t,s){e(t.exports,"attachXidToMultipleEvents",()=>r);async function r(e,t){try{let s=await t;return e.map(e=>(function(e,t){if(!(t&&t instanceof Function))return e;if(e.msg.type===a("ajFzF").SegmentEventTypes.PAGE||e.msg.type===a("ajFzF").SegmentEventTypes.TRACK){let s=t();s&&Array.isArray(s)&&(e.msg.properties={...e.msg.properties,xid:s})}else if(e.msg.traits&&e.msg.type===a("ajFzF").SegmentEventTypes.IDENTIFY){let s=t();s&&Array.isArray(s)&&(e.msg.traits={...e.msg.traits,xid:s})}return e})(e,s))}catch(t){return e}}}),n("ajFzF",function(t,s){var r,i,a,n,o,l;e(t.exports,"SegmentEventTypes",()=>r),(n=r||(r={})).IDENTIFY="identify",n.PAGE="page",n.TRACK="track",(o=i||(i={})).XC="xc",o.UID="uid",(l=a||(a={})).NEW="NEW",l.CHANGED="CHANGED",l.EXISTING="EXISTING",l.TIMEOUT="TIMEOUT",l.ERROR="ERROR",l.UNAVAILABLE="UNAVAILABLE",l.MALFORMED="MALFORMED",l.UNKNOWN="UNKNOWN"}),n("ajscq",function(t,s){e(t.exports,"DEFAULT_REQUEST_TIMEOUT",()=>r);let r=1e4}),n("e1MV9",function(t,s){e(t.exports,"sendEvents",()=>r);let r=async e=>{let t=i(e)?.signal,s=n(e.url),r=await fetch(e.url,{method:"POST",headers:{"Content-Type":"text/plain"},body:JSON.stringify(e.batch),signal:t,...s});if(429===r.status||r.status>=500&&r.status<600)throw Error(`HTTP Error ${r.status} (${r.statusText})`);return r},i=e=>{if(e.abortController)return e.abortController;if(e.timeout){let t=new AbortController;return setTimeout(()=>{t.abort()},e.timeout),t}},n=(0,a("5iWql").default)(e=>{let t=new URL(e).origin;return t===location.origin?{}:{mode:"cors",credentials:"include"}})}),n("jq5wq",function(s,r){e(s.exports,"default",()=>c);var i=a("dFBS3");let n="SAFE",o="UNSAFE",l="LOCAL_STORAGE";class c{constructor(e){this.store=new(a("fyBQ8")).default({useStoragePrefix:!1}),this.cookie=new(a("g1QKY")).default(e)}getUserId(){return this.userId||null}setUserId(e){this.userId=e}getAnonymousId(e){return this.getAnonymousIdFromLocalStorageAndUpdateCookieIfStale()||this.getAnonymousIdFromCookieAndUpdateLocalStorage()||this.generateNewAnonymousId(e)}setAnonymousId(e){let t=JSON.stringify(e);return this.cookie.set(a("7rSBS").AWCCookiesKeys.AJS_ANONYMOUS_ID,t),this.lastAnonymousIdCookieUpdate=Date.now(),this.store.setItem((0,a("7rSBS").AllAnalyticsCookies).AJS_ANONYMOUS_ID.getKey(),t)}getAnonymousIdFromStorage(e){let t=e===l?this.store.getItem((0,a("7rSBS").AllAnalyticsCookies).AJS_ANONYMOUS_ID.getKey()):this.cookie.get(a("7rSBS").AWCCookiesKeys.AJS_ANONYMOUS_ID);if(t){let e={type:o,anonymousId:t};try{let s=JSON.parse(t);if(s&&"string"==typeof s)return{type:n,anonymousId:s};return e}catch(t){return e}}return{type:"NOT_FOUND"}}getAnonymousIdFromLocalStorageAndUpdateCookieIfStale(){let e=this.getAnonymousIdFromStorage(l),t=!1;switch((!this.lastAnonymousIdCookieUpdate||(0,a("d2wNG").default)(new Date,new Date(this.lastAnonymousIdCookieUpdate))>=7)&&(t=!0),e.type){case n:return t&&this.setAnonymousId(e.anonymousId),e.anonymousId;case o:return e.anonymousId;default:return null}}getAnonymousIdFromCookieAndUpdateLocalStorage(){let e=this.getAnonymousIdFromStorage("COOKIE");switch(e.type){case n:case o:return this.store.setItem((0,a("7rSBS").AllAnalyticsCookies).AJS_ANONYMOUS_ID.getKey(),JSON.stringify(e.anonymousId)),e.anonymousId;default:return null}}generateNewAnonymousId(e=t(i)){let s=e();return this.setAnonymousId(s),s}}}),n("7rSBS",function(t,s){var r,i;e(t.exports,"AWCCookiesKeys",()=>r),e(t.exports,"AllAnalyticsCookies",()=>o),(i=r||(r={})).AWC_TLD_TEST="AWC_TLD_TEST",i.AWC_ANALYTICS_DEBUG="AWC_ANALYTICS_DEBUG",i.AJS_ANONYMOUS_ID="AJS_ANONYMOUS_ID";class a{constructor(e,t){this.key=e,this.options=t}getAttributes(){return this.options}getKey(){return this.key}}let n=()=>{try{return window&&window.location&&"https:"===window.location.protocol}catch(e){return!1}},o={AWC_TLD_TEST:new a("__awc_tld_test__",{expires:365,secure:n(),path:"/"}),AWC_ANALYTICS_DEBUG:new a("atlassian_analytics_debug",{expires:365,secure:n(),path:"/"}),AJS_ANONYMOUS_ID:new a("ajs_anonymous_id",{expires:365,secure:n(),path:"/"})}}),n("g1QKY",function(s,r){e(s.exports,"default",()=>n);var i=a("M2DFp");class n{constructor(e){this.cookieLike=(0,a("lflnQ").canUseCookie)(e)?t(i):new(a("5HLLg")).default}set(e,t,s){if(!a("7rSBS").AllAnalyticsCookies[e]){console.warn(`Unknown cookie key ${e} provided, not set.`);return}return this.cookieLike.set((0,a("7rSBS").AllAnalyticsCookies)[e].getKey(),t,{...(0,a("7rSBS").AllAnalyticsCookies)[e].getAttributes(),domain:(0,a("lflnQ").getTld)(),...s})}get(e){if(!a("7rSBS").AllAnalyticsCookies[e]){console.warn(`Unknown cookie key ${e} provided, not fetched.`);return}return this.cookieLike.get((0,a("7rSBS").AllAnalyticsCookies)[e].getKey())}remove(e,t){if(!a("7rSBS").AllAnalyticsCookies[e]){console.warn(`Unknown cookie key ${e} provided, not removed.`);return}this.cookieLike.remove((0,a("7rSBS").AllAnalyticsCookies)[e].getKey(),{...t})}}}),n("5HLLg",function(t,s){e(t.exports,"default",()=>r);class r{constructor(){this.safeStorage=new(a("fyBQ8")).default({useStoragePrefix:!1})}set(e,t){return this.safeStorage.setItem(e,t),t}get(e){let t=this.safeStorage.getItem(e);return t||void 0}remove(e){this.safeStorage.removeItem(e)}}}),n("fyBQ8",function(t,s){e(t.exports,"default",()=>r);class r extends a("8hQG2").default{constructor(e){let t;try{t=window.localStorage||a("3l39D").default}catch(e){t=a("3l39D").default}super(t,e)}}}),n("3l39D",function(t,s){e(t.exports,"default",()=>r);var r=new class{constructor(){this._data={},this.length=0,this.setItem=(e,t)=>(this._data[e]=t,this.length=Object.keys(this._data).length,t),this.getItem=e=>e in this._data?this._data[e]:null,this.removeItem=e=>(e in this._data&&delete this._data[e],this.length=Object.keys(this._data).length,null),this.clear=()=>{this._data={},this.length=0},this.key=e=>Object.keys(this._data)[e]}}}),n("8hQG2",function(t,s){e(t.exports,"default",()=>n);let r="awcInMemoryStorageFallback";function i(e){let t="test_value";if(!e)return!1;try{let s="awc.storage.support";e.setItem(s,t);let r=e.getItem(s);return e.removeItem(s),r===t}catch(e){return!1}}class n{constructor(e,t={}){this.getStore=()=>this._store,this.getItem=e=>this._store.getItem(this.createKey(e)),this.removeItem=e=>this._store.removeItem(this.createKey(e)),this.setItem=(e,t)=>{try{this._store.setItem(this.createKey(e),t)}catch(s){(function(e){let t=!1;if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else -2147024882===e.number&&(t=!0);return t})(s)&&(this.swapToInMemory(),this._store.setItem(this.createKey(e),t))}},this.swapToInMemory=()=>{let e;if(this._store===a("3l39D").default||"undefined"==typeof window)return;let t=Object.keys(this._store||{});i(window[r])?e=window[r]:(e=a("3l39D").default,window[r]||(window[r]=a("3l39D").default)),t.forEach(t=>{if(0===t.indexOf(this.getPrefix())){let s=this._store.getItem(t);s&&e.setItem(t,s)}}),this._store=e},this.clear=()=>this._store.clear(),this.key=e=>this._store.key(e),this.getPrefix=()=>this._prefix,this.createKey=e=>this._prefix?`${this.getPrefix()}.${e}`:e,this.options=t;let s=[];(void 0===t.useStoragePrefix||t.useStoragePrefix)&&s.push("awc"),t.envPrefix&&t.envPrefix!==a("9Q7Jj").envType.PROD&&s.push(t.envPrefix),this._prefix=s.join("-"),i(e)?this._store=e:this.swapToInMemory()}}}),n("lflnQ",function(s,r){e(s.exports,"canUseCookie",()=>n),e(s.exports,"getTld",()=>c);var i=a("M2DFp");let n=(e=!1)=>!e&&!("file:"===location.protocol||"chrome-extension:"===location.protocol),o=(0,a("7rSBS").AllAnalyticsCookies).AWC_TLD_TEST.getKey(),l="tld_test",c=(0,a("5iWql").default)(()=>{if("undefined"==typeof location)return"";let{hostname:e}=location,s=e.split(".");for(let e=1;e<=s.length;e++){let r=s.slice(-1*e),a=`.${r.join(".")}`;if(t(i).set(o,l,{domain:a}),t(i).get(o)===l)return t(i).remove(o,{domain:a}),a}return e})}),n("k2lCJ",function(s,r){e(s.exports,"buildContext",()=>n),e(s.exports,"prepareEventProperties",()=>o);var i=a("kpOtk");let n=e=>({...e.context,userAgent:navigator.userAgent}),o=e=>{let s=l(e);return t(i)(s)},l=e=>{if(null===e||"object"!=typeof e)return e;let t={};return Object.keys(e).forEach(s=>{let r=c(e,s);void 0!==r&&(Array.isArray(r)?t[s]=r.map(e=>l(e)):"object"==typeof r&&null!==r?t[s]=l(r):t[s]=r)}),t},c=(e,t)=>e[t]}),n("f7rk3",function(t,s){e(t.exports,"default",()=>r);class r{constructor(){this.handleOriginParameters=(e,t)=>{let s=Object.keys(e);if(!(s.length>0))throw Error("Empty parameter mapping provided");let r=s.filter(e=>0>Object.values(a("9Q7Jj").originTracingType).indexOf(e));if(r.length>0)throw Error(`Invalid Origin Tracing Parameter(s) supplied: ${r.join()}!`);let i=(0,a("gldVk").default)((e,t)=>s.indexOf(t)>=0,t),n=Object.keys(i).map(t=>{let s=e[t](i[t]);return{[t]:s}}).reduce((e,t)=>Object.assign(e,t),{});return n},this._originStore={}}}}),n("gldVk",function(t,s){e(t.exports,"defaultHistoryReplaceFn",()=>i),e(t.exports,"default",()=>n);var r=a("kFOO4");let i=e=>window.history.replaceState({},"",e);var n=(e,t=i)=>{let s=window.location.href,n=window.location.hash,o=""!==n?s.replace(n,""):s,{url:l,query:c}=(0,r.parseUrl)(o),u=(0,a("7CSD8").pickBy)(c,e);if(Object.keys(u).length>0){let s=(0,a("7CSD8").omitBy)(c,e);if(Object.keys(s).length>0){let e=`${l}?${(0,r.stringify)(s)}${n}`;t(e)}else t(`${l}${n}`)}return u}}),n("kFOO4",function(t,s){e(t.exports,"extract",()=>r,e=>r=e),e(t.exports,"parse",()=>i,e=>i=e),e(t.exports,"stringify",()=>n,e=>n=e),e(t.exports,"parseUrl",()=>o,e=>o=e),e(t.exports,"stringifyUrl",()=>l,e=>l=e),e(t.exports,"pick",()=>c,e=>c=e);var r,i,n,o,l,c,u=a("hXDaG"),d=a("bJEvY"),h=a("9CHQr"),p=a("aARfw");let g=e=>null==e,m=Symbol("encodeFragmentIdentifier");function f(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function y(e,t){return t.encode?t.strict?u(e):encodeURIComponent(e):e}function E(e,t){return t.decode?d(e):e}function v(e){let t=e.indexOf("#");return -1!==t&&(e=e.slice(0,t)),e}function I(e){e=v(e);let t=e.indexOf("?");return -1===t?"":e.slice(t+1)}function b(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):t.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())&&(e="true"===e.toLowerCase()),e}function T(e,t){f((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);let s=function(e){let t;switch(e.arrayFormat){case"index":return(e,s,r)=>{if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t){r[e]=s;return}void 0===r[e]&&(r[e]={}),r[e][t[1]]=s};case"bracket":return(e,s,r)=>{if(t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),!t){r[e]=s;return}if(void 0===r[e]){r[e]=[s];return}r[e]=[].concat(r[e],s)};case"colon-list-separator":return(e,s,r)=>{if(t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),!t){r[e]=s;return}if(void 0===r[e]){r[e]=[s];return}r[e]=[].concat(r[e],s)};case"comma":case"separator":return(t,s,r)=>{let i="string"==typeof s&&s.includes(e.arrayFormatSeparator),a="string"==typeof s&&!i&&E(s,e).includes(e.arrayFormatSeparator);s=a?E(s,e):s;let n=i||a?s.split(e.arrayFormatSeparator).map(t=>E(t,e)):null===s?s:E(s,e);r[t]=n};case"bracket-separator":return(t,s,r)=>{let i=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!i){r[t]=s?E(s,e):s;return}let a=null===s?[]:s.split(e.arrayFormatSeparator).map(t=>E(t,e));if(void 0===r[t]){r[t]=a;return}r[t]=[].concat(r[t],a)};default:return(e,t,s)=>{if(void 0===s[e]){s[e]=t;return}s[e]=[].concat(s[e],t)}}}(t),r=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return r;for(let i of e.split("&")){if(""===i)continue;let[e,a]=h(t.decode?i.replace(/\+/g," "):i,"=");a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:E(a,t),s(E(e,t),a,r)}for(let e of Object.keys(r)){let s=r[e];if("object"==typeof s&&null!==s)for(let e of Object.keys(s))s[e]=b(s[e],t);else r[e]=b(s,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((e,t)=>{let s=r[t];return s&&"object"==typeof s&&!Array.isArray(s)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(s):e[t]=s,e},Object.create(null))}r=I,i=T,n=(e,t)=>{if(!e)return"";f((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);let s=s=>t.skipNull&&g(e[s])||t.skipEmptyString&&""===e[s],r=function(e){switch(e.arrayFormat){case"index":return t=>(s,r)=>{let i=s.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?s:null===r?[...s,[y(t,e),"[",i,"]"].join("")]:[...s,[y(t,e),"[",y(i,e),"]=",y(r,e)].join("")]};case"bracket":return t=>(s,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?s:null===r?[...s,[y(t,e),"[]"].join("")]:[...s,[y(t,e),"[]=",y(r,e)].join("")];case"colon-list-separator":return t=>(s,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?s:null===r?[...s,[y(t,e),":list="].join("")]:[...s,[y(t,e),":list=",y(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{let t="bracket-separator"===e.arrayFormat?"[]=":"=";return s=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:(i=null===i?"":i,0===r.length)?[[y(s,e),t,y(i,e)].join("")]:[[r,y(i,e)].join(e.arrayFormatSeparator)]}default:return t=>(s,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?s:null===r?[...s,y(t,e)]:[...s,[y(t,e),"=",y(r,e)].join("")]}}(t),i={};for(let t of Object.keys(e))s(t)||(i[t]=e[t]);let a=Object.keys(i);return!1!==t.sort&&a.sort(t.sort),a.map(s=>{let i=e[s];return void 0===i?"":null===i?y(s,t):Array.isArray(i)?0===i.length&&"bracket-separator"===t.arrayFormat?y(s,t)+"[]":i.reduce(r(s),[]).join("&"):y(s,t)+"="+y(i,t)}).filter(e=>e.length>0).join("&")},o=(e,t)=>{t=Object.assign({decode:!0},t);let[s,r]=h(e,"#");return Object.assign({url:s.split("?")[0]||"",query:T(I(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:E(r,t)}:{})},l=(e,t)=>{t=Object.assign({encode:!0,strict:!0,[m]:!0},t);let s=v(e.url).split("?")[0]||"",a=r(e.url),o=i(a,{sort:!1}),l=Object.assign(o,e.query),c=n(l,t);c&&(c=`?${c}`);let u=function(e){let t="",s=e.indexOf("#");return -1!==s&&(t=e.slice(s)),t}(e.url);return e.fragmentIdentifier&&(u=`#${t[m]?y(e.fragmentIdentifier,t):e.fragmentIdentifier}`),`${s}${c}${u}`},c=(e,t,s)=>{s=Object.assign({parseFragmentIdentifier:!0,[m]:!1},s);let{url:r,query:i,fragmentIdentifier:a}=o(e,s);return l({url:r,query:p(i,t),fragmentIdentifier:a},s)}}),n("3x9by",function(t,s){e(t.exports,"selectHost",()=>c);let r="/gateway/api/gasv3/api/v1",i=()=>"as.staging.atl-paas-us-gov-mod.net/api/v1",n=()=>"api.stg.atlassian-us-gov-mod.com/gasv3/api/v1",o=({useStargate:e,env:t,useLegacyUrl:s,envOverride:o})=>{if(t===a("9Q7Jj").envType.LOCAL||t===a("9Q7Jj").envType.DEV)throw Error("No LOCAL or DEV environments for FedRAMP.");if(t===a("9Q7Jj").envType.PROD&&o)throw Error("Cannot override to FedRAMP Sandbox for Prod.");return e?s?t===a("9Q7Jj").envType.PROD?"api.atlassian-us-gov-mod.com/gasv3/api/v1":n():window.location.host+r:t===a("9Q7Jj").envType.PROD?"as.atlassian-us-gov-mod.com/api/v1":i()},l=({useStargate:e,env:t,useLegacyUrl:s})=>e?s?t===a("9Q7Jj").envType.PROD?"api-private.atlassian.com/gasv3/api/v1":"api-private.stg.atlassian.com/gasv3/api/v1":window.location.host+r:t===a("9Q7Jj").envType.PROD?"as.atlassian.com/api/v1":"as.staging.atl-paas.net/api/v1";function c({useStargate:e,env:t,useLegacyUrl:s,perimeter:r,envOverride:i}){return r===a("9Q7Jj").perimeterType.FEDRAMP_MODERATE?o({useStargate:e,env:t,useLegacyUrl:s,envOverride:i}):l({useStargate:e,env:t,useLegacyUrl:s})}}),n("dmP6K",function(t,s){e(t.exports,"default",()=>l);let r="session.id",i="session.expiry",n=/^\d+$/,o=()=>{};class l{constructor(e={}){this._generateNewSessionId=()=>{let e=Date.now().toString();return this._safeLocalStorage.setItem(r,e),this._onNewSessionStarted&&this._onNewSessionStarted(),e},this._updateSessionExpiry=()=>{let e=Date.now()+this._sessionExpiryTime;return this._safeLocalStorage.setItem(i,e.toString()),e},this._debouncedUpdateSessionExpiry=e=>{let{_updateSessionExpiry:t}=this;if(e<Date.now()+this._sessionExpiryDebounceThresholdPercentage*this._sessionExpiryTime)return t();this._sessionExpiryDebounceTimer&&clearTimeout(this._sessionExpiryDebounceTimer),this._sessionExpiryDebounceTimer=setTimeout(()=>{t()},this._sessionExpiryDebounce)},this._sessionExpiryTime=e.sessionExpiryTime||18e5,this._sessionExpiryDebounce=e.sessionExpiryDebounce||5e3,this._sessionExpiryDebounceThresholdPercentage=e.sessionExpiryDebounceThresholdPercentage||.9,this._onNewSessionStarted=e.onNewSessionStarted?e.onNewSessionStarted:o,this._safeLocalStorage=new(a("fyBQ8")).default}getCurrentSessionId(){let e=this._safeLocalStorage.getItem(r),t=parseInt(this._safeLocalStorage.getItem(i)||"0",10)||0;return(this._debouncedUpdateSessionExpiry(t),!e||t<=Date.now()||Number.isNaN(t)||!n.test(e))?this._generateNewSessionId():e}}}),n("9cB7N",function(t,s){e(t.exports,"default",()=>r);class r extends a("8hQG2").default{constructor(e){let t;try{t=window.sessionStorage||a("3l39D").default}catch(e){t=a("3l39D").default}super(t,e)}}}),n("fvEdY",function(s,r){e(s.exports,"default",()=>o);var i=a("dFBS3");let n="tab.id";class o{constructor(){this._generateNewTabId=()=>{let e=t(i)();return this._safeSessionStorage.setItem(n,e),e},this._safeSessionStorage=new(a("9cB7N")).default}getCurrentTabId(){let e=this._safeSessionStorage.getItem(n);return e||(e=this._generateNewTabId()),e}}}),n("hMvQq",function(s,r){e(s.exports,"default",()=>u);var i=a("kFOO4"),n=a("dFBS3");let o="taskSessions",l="taskSessionsInit",c="awc.";class u{constructor(){this._taskSessionsNotRecentlyInitialised=e=>null===this._safeSessionStorage.getItem(o)||null===this._safeSessionStorage.getItem(l)||parseInt(this._safeSessionStorage.getItem(l)||"0",10)<e-3e3,this._removeTaskSessionPrefix=(e,t)=>t.split(c)[1],this._isTaskSessionQueryParam=(e,t)=>t.startsWith(c),this.getAllTaskSessions=()=>{try{return JSON.parse(this._safeSessionStorage.getItem(o)||"")}catch(e){return{}}},this._writeToSessionStorage=e=>{try{this._safeSessionStorage.setItem(o,JSON.stringify(e))}catch(e){}},this._appendTaskSessions=e=>{let t=this.getAllTaskSessions(),s=null===t?e:Object.assign(t,e);this._writeToSessionStorage(s)},this._safelyRemoveKey=(e,t)=>null===e?{}:(delete e[t],e),this.createTaskSession=e=>{let s=t(n)(),r={};return r[e]=s,this._appendTaskSessions(r),s},this.createTaskSessionWithProvidedId=(e,t)=>{if("string"!=typeof t)throw TypeError("invalid taskSessionId, must be string");let s={};s[e]=t,this._appendTaskSessions(s)},this.completeTaskSession=e=>{let t=this.getAllTaskSessions(),s=this._safelyRemoveKey(t,e);this._writeToSessionStorage(s)},this.formatTaskSessionQueryString=({uri:e,includedTaskSessions:t})=>{let{url:s,query:r}=(0,i.parseUrl)(e),n=this.getAllTaskSessions(),o=t?(0,a("7CSD8").pick)(n,t):(0,a("7CSD8").omit)(n,Object.values(a("9Q7Jj").originTracingType));if(0===Object.keys(o).length)return e;let l={...(0,a("7CSD8").mapKeys)(o,(e,t)=>c+t),...r};return`${s}?${(0,i.stringify)(l)}`},this.stripQueryParameters=()=>{let e=(0,a("7CSD8").mapKeys)((0,a("gldVk").default)(this._isTaskSessionQueryParam),this._removeTaskSessionPrefix);this._appendTaskSessions(e)};let e=Date.now();this._safeSessionStorage=new(a("9cB7N")).default;try{this._taskSessionsNotRecentlyInitialised(e)&&(this._writeToSessionStorage({}),this._safeSessionStorage.setItem(l,e.toString()))}catch(e){}}}}),n("2JP86",function(s,r){e(s.exports,"default",()=>c);var i=a("M2DFp");let n=(0,a("7rSBS").AllAnalyticsCookies).AWC_ANALYTICS_DEBUG.getKey(),o="synthetic",l=()=>{try{return JSON.parse(t(i).get(n)||"false")}catch(e){t(i).remove(n)}return!1};var c=class{constructor(){this._bind=()=>{"undefined"==typeof window||window.testAnalytics||(window.testAnalytics={eventCache:[],events:()=>window.testAnalytics.eventCache,clear:()=>{window.testAnalytics.eventCache=[];try{localStorage.removeItem("awc.ui.viewed.last.sent"),localStorage.removeItem("awc-staging.ui.viewed.last.sent"),localStorage.removeItem("awc-dev.ui.viewed.last.sent"),localStorage.removeItem("awc-local.ui.viewed.last.sent")}catch(e){}}})},this._cache=e=>{"undefined"!=typeof window&&(window.testAnalytics.eventCache.length>=100&&(window.testAnalytics.eventCache=window.testAnalytics.eventCache.slice(1,window.testAnalytics.eventCache.length)),window.testAnalytics.eventCache.push(e))},this._shouldCacheEvent=()=>this._isDebugCookieEnabled,this.saveEvent=e=>{e&&this._shouldCacheEvent()&&(window.testAnalytics||this._bind(),e.tags instanceof Array?e.tags.push(o):e.tags=[o],this._cache(e))},this._isDebugCookieEnabled=l(),this._isDebugCookieEnabled&&this._bind()}}}),n("jmu0Y",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e,t,s,r={}){if(this.start=()=>{this._startInterval(),this._bindEventListeners()},this.stop=()=>{this._stopInterval(),this._unbindEventListeners()},this.resetTimers=()=>{this._intervalId&&(this.stop(),this.start())},this._bindEventListeners=()=>{"undefined"!=typeof window&&(window.addEventListener("focus",this._focusListener),window.addEventListener("blur",this._blurListener))},this._unbindEventListeners=()=>{"undefined"!=typeof window&&(window.removeEventListener("focus",this._focusListener),window.removeEventListener("blur",this._blurListener))},this._startInterval=()=>{clearInterval(this._intervalId),this._intervalId=setInterval(this._handleInterval,this._delay)},this._stopInterval=()=>{this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)},this._getProductKey=(e,t)=>{let s=e;return t&&(s+=`-${t}`),s},this._getLastSentTimestamp=(e,t,s)=>{let r=(((this._parseLocalStorageData()||{})[s]||{})[t]||{})[e]||null;return r},this._parseLocalStorageData=()=>{let e=this._safeLocalStorage.getItem(this._storageKey);try{return JSON.parse(e||"")}catch(e){return this._safeLocalStorage.removeItem(this._storageKey),null}},this._setLastSentTimestamp=(e,t,s)=>{let r=this._parseLocalStorageData()||{},i=r[s]||{},a=i[t]||{};a[e]=Date.now(),i[t]=a,r[s]=i,this._safeLocalStorage.setItem(this._storageKey,JSON.stringify(r))},this._shouldSendEvent=(e,t,s,r)=>{if(!document.hasFocus()||t!==a("9Q7Jj").tenantType.NONE&&!s||!r)return!1;let i=Date.now()-this._getLastSentTimestamp(e,s,r);return i>this._throttle},this._handleInterval=()=>{let{embeddedProduct:e,...t}=this._getContext();this._sendEvent(this._product,t),e&&this._sendEvent(e,t,!0)},this._sendEvent=(e,t,s=!1)=>{let{subproduct:r,tenantIdType:i,tenantId:a,userId:n,lastScreenEvent:o,attributes:l}=t,c=this._getProductKey(e,r);if(this._shouldSendEvent(c,i,a,n)){this._setLastSentTimestamp(c,a,n);let t=this._createEvent(e,r,s,o,l);this._onEvent(t)}},this._createEvent=(e,t,s,r,i)=>{let a={product:e,source:"ui",action:"viewed",actionSubject:"ui",attributes:i};return s&&(a.subproduct=null,a.version=null,a.attributes={...a.attributes,embeddedInEnv:this._productInfo.env,embeddedInProduct:this._productInfo.product,embeddedInSubproduct:t,embeddedInVersion:this._productInfo.version,embeddedInOrigin:this._productInfo.origin,embeddedInPlatform:this._productInfo.platform}),r&&(a.attributes={...a.attributes,lastScreenEvent:{name:r.name,attributes:r.attributes}}),a},!e)throw Error("Missing productInfo");if(!e.product)throw Error("Missing productInfo.product");if(!t)throw Error("Missing getContext callback");if("function"!=typeof t)throw Error("Invalid getContext, must be function");if(!s)throw Error("Missing onEvent callback");if("function"!=typeof s)throw Error("Invalid onEvent, must be function");this._productInfo=e,this._product=e.product,this._getContext=t,this._onEvent=s,this._delay=r.delay||2e3,this._throttle=r.throttle||36e5,this._storageKey=r.storageKey||"ui.viewed.last.sent",this._safeLocalStorage=new(a("fyBQ8")).default({envPrefix:this._productInfo.env}),this._focusListener=()=>{this._startInterval()},this._blurListener=()=>{this._stopInterval()}}}}),n("lSU8C",function(t,s){e(t.exports,"default",()=>r);function r(e,t){return e&&"function"==typeof e?()=>{e(t)}:null}}),n("4uAp5",function(t,s){e(t.exports,"XIDPromise",()=>r);let r=(e,t)=>{if(e&&t&&"function"==typeof t)return Promise.race([t().catch(()=>()=>(0,a("aMlQH").createUnknownXid)()),new Promise(e=>{setTimeout(()=>e(()=>(0,a("aMlQH").createTimeoutXid)()),a("aMlQH").XID_TIMEOUT)})])}}),n("aMlQH",function(t,s){e(t.exports,"XID_TIMEOUT",()=>r),e(t.exports,"createTimeoutXid",()=>i),e(t.exports,"createUnknownXid",()=>n);let r=5e3,i=()=>[{type:a("eoJHe").XIDItemType.XC,state:"TIMEOUT"},{type:a("eoJHe").XIDItemType.UID,state:"TIMEOUT"}],n=()=>[{type:a("eoJHe").XIDItemType.XC,state:"UNKNOWN"},{type:a("eoJHe").XIDItemType.UID,state:"UNKNOWN"}]}),n("eoJHe",function(t,s){var r,i,a,n;e(t.exports,"XIDItemType",()=>r),(a=r||(r={})).XC="xc",a.UID="uid",(n=i||(i={})).NEW="NEW",n.CHANGED="CHANGED",n.EXISTING="EXISTING",n.TIMEOUT="TIMEOUT",n.ERROR="ERROR",n.UNAVAILABLE="UNAVAILABLE",n.MALFORMED="MALFORMED",n.UNKNOWN="UNKNOWN"}),n("iYbT7",function(t,s){e(t.exports,"canCompress",()=>r),e(t.exports,"buildCompressionFunction",()=>n);let r=e=>"feature"===e.actionSubject&&"exposed"===e.action&&"operational"===e.eventType&&e.attributes&&e.tags&&e.tags.includes("measurement")&&!e.tags.includes("hasCustomAttributes"),i=(e,t=50)=>{if(!e||e.length<=0)return[];if(t<=0)throw Error("Batch size must be greater than 0");let s=e.map(e=>{let{flagKey:t,value:s,reason:r,ruleId:i,errorKind:a}=e.attributes;return{key:t,value:s,...r&&{reason:r},...i&&{ruleId:i},...a&&{errorKind:a}}});return a(s,t)},a=(e,t)=>{let s=[];for(let r=0;r<e.length;r+=t){let i=e.slice(r,r+t);s.push({actionSubject:"features",action:"exposed",eventType:"operational",attributes:{evaluations:i},tags:["measurement"],source:"@atlassian/exposure-events-compressor"})}return s},n=e=>t=>i(t,e)}),n("a5oBw",function(s,r){e(s.exports,"default",()=>o);var i=a("eUqFw");let n=(0,a("gUSUi").default)()(a("3xGTJ").EngagementProvider);var o=(0,a("5EENj").default)(e=>t(i).createElement(n,{...e,store:(0,a("bRidJ").default)(e.config)}))}),n("5EENj",function(s,r){e(s.exports,"default",()=>n);var i=a("eUqFw");function n(e){let s=t(i).createContext(!1);return function(r){return t(i).createElement(s.Consumer,null,a=>a?r.children:t(i).createElement(s.Provider,{value:!0},t(i).createElement(e,r)))}}}),n("bRidJ",function(s,r){e(s.exports,"store",()=>c),e(s.exports,"default",()=>u);var i=a("hTLlD"),n=a("huRi7");let o={messageMapping:new Map,current:null,initialized:!1,initializing:!1,config:{cloudId:"",aaid:"",locale:"",product:"",stargateUrl:"",orgId:"",workspaceId:""}},l=(0,a("7DgP1").createCancellationToken)(),c=(0,n.createStore)((e=o,s)=>{switch(s.type){case a("1B2U3").SET_MESSAGE_MAPPING:return{...e,initialized:!0,initializing:!1,messageMapping:s.messageMapping};case a("1B2U3").SET_INITIALIZING:return{...e,config:s.config,initializing:!0};case a("1B2U3").SET_CURRENT:{let{eventMapping:r}=s,{message:a,component:n}=r,o=function(e,s){let r=new Map;return e.forEach((e,a)=>{t(i)(e.component,s)||r.set(a,e)}),r}(e.messageMapping,n);return{...e,current:{messageId:a.messageId,variationId:a.variationId,...n},messageMapping:o}}case a("1B2U3").CLEAR_CURRENT:return{...e,current:null};case a("1B2U3").RESET_STORE:return o;default:return e}});var u=e=>{let t=c.getState();if(t.initializing||t.initialized){if(t.config.cloudId===e.cloudId)return c;l.isCancelled=!0,l=(0,a("7DgP1").createCancellationToken)(),c.dispatch((0,a("1B2U3").resetStore)())}let s={...e};return s.locale=s.locale.replace("_","-"),c.dispatch((0,a("1B2U3").initialize)(s)),(0,a("1XdiR").isMessagingEnabled)()&&(0,a("evBrC").processMessages)(c,s,l),c}}),n("7DgP1",function(t,s){e(t.exports,"createCancellationToken",()=>r);function r(e=!1){return{isCancelled:e}}}),n("1XdiR",function(t,s){e(t.exports,"isMessagingEnabled",()=>r);function r(){return!(0,a("kUpy5").isFedRamp)()}}),n("1B2U3",function(t,s){e(t.exports,"SET_MESSAGE_MAPPING",()=>r),e(t.exports,"SET_INITIALIZING",()=>i),e(t.exports,"RESET_STORE",()=>a),e(t.exports,"CLEAR_CURRENT",()=>n),e(t.exports,"SET_CURRENT",()=>o),e(t.exports,"resetStore",()=>l),e(t.exports,"initialize",()=>c),e(t.exports,"setMessageMapping",()=>u),e(t.exports,"setCurrent",()=>d),e(t.exports,"clearCurrent",()=>h);let r="SET_MESSAGE_MAPPING",i="SET_INITIALIZING",a="RESET_STORE",n="CLEAR_CURRENT",o="SET_CURRENT",l=()=>({type:a}),c=e=>({type:i,config:e}),u=e=>({type:r,messageMapping:e});function d(e){return{type:o,eventMapping:e}}function h(){return{type:n}}}),n("evBrC",function(t,s){e(t.exports,"processMessages",()=>i);let r=e=>{let t=new Map;return e.forEach(e=>{let s=e.components;s.forEach((r,i)=>{r.triggers.forEach(a=>{t.set(a,{message:e,component:{componentId:i,isLast:i===s.length-1,...r}})})})}),t};async function i(e,t,s){let n,o;if(s.isCancelled)return;let l=(0,a("bRidJ").store).getState(),{cloudId:c,stargateUrl:u,product:d,locale:h}=t;try{let e=await (0,a("3Li4R").getMessages)(c,u,d,h);if(s.isCancelled)return;n=e.messages,o=e.interval}catch(e){return}if(null===l.current){let t=r(n);e.dispatch((0,a("1B2U3").setMessageMapping)(t))}0!==o&&setTimeout(()=>{i(e,t,s)},1e3*o)}}),n("3Li4R",function(s,r){let i;e(s.exports,"getMessages",()=>u),e(s.exports,"startMessage",()=>f),e(s.exports,"stopMessage",()=>y),e(s.exports,"sendUserResponse",()=>w),e(s.exports,"markAsSeenAndFatigued",()=>A);var n,o,l=a("asbhz");let c=t(l).parse("/engage-targeting/api/v2/user/{cloudId}/in-product-messages{?product,schema,locale}");async function u(e,t,s,r){return(0,a("jLhkN").stargateFetchRetryOn5xx)(`${t}${c.expand({cloudId:e,product:s,schema:"2",locale:r})}`).then(a("jLhkN").errorIfNotOk).then(e=>e.json().then(t=>({messages:t,interval:Number.parseFloat(e.headers.get("POLL-INTERVAL")||"0")})))}function h(e){return e.status===d}let p=t(l).parse("/engage-targeting/api/v2/user/messages/{messageId}/start"),g=t(l).parse("/engage-targeting/api/v2/user/messages/{messageId}/start/{variationId}"),m=t(l).parse("/engage-targeting/api/v2/user/messages/{messageId}/stop");async function f(e,t){return t?.enableChoreographer?E(e,t):I(e)}async function y(e,t){return t?.enableChoreographer?v(e,t):b(e)}async function E(e,t){return i||(i=new(a("kkBs4")).EngagekitChoreographerPlugin(t.envType??"local")),i.startMessageWithPlugin(e.messageId,()=>I(e,!0),t.additionalData)}async function v(e,t){return i||(i=new(a("kkBs4")).EngagekitChoreographerPlugin(t.envType??"local")),i.stopMessageWithPlugin(e.messageId,()=>b(e,!0),t.additionalData)}async function I(e,t=!1){let s={cloudId:e.cloudId,orgId:e.orgId,workspaceId:e.workspaceId,choreographerEnabled:t};return(0,a("jLhkN").stargateFetchRetryOn5xx)(e.variationId?`${e.stargateUrl}${g.expand({messageId:e.messageId,variationId:e.variationId})}`:`${e.stargateUrl}${p.expand({messageId:e.messageId})}`,{method:"post",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(a("jLhkN").pullResponseTextIfNotOk).then(h)}async function b(e,t=!1){let s={cloudId:e.cloudId,orgId:e.orgId,workspaceId:e.workspaceId,choreographerEnabled:t};return(0,a("jLhkN").stargateFetchRetryOn5xx)(`${e.stargateUrl}${m.expand({messageId:e.messageId})}`,{method:"post",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}}).then(a("jLhkN").pullResponseTextIfNotOk).then(h)}(n=o||(o={})).LOCAL="local",n.DEV="dev",n.STAGING="staging",n.PROD="prod";let T=t(l).parse("/engage-targeting/api/v2/user/{cloudId}/messages/{messageId}/response");async function w(e,t,s,r){return(0,a("jLhkN").stargateFetchRetryOn5xx)(`${t}${T.expand({cloudId:e,messageId:s})}`,{method:"post",body:JSON.stringify(r),headers:{"Content-Type":"application/json"}}).then(a("jLhkN").pullResponseTextIfNotOk).then(()=>Promise.resolve())}let S=t(l).parse("/engage-targeting/api/v2/user/messages/{messageId}/seen");async function A(e){let t={cloudId:e.cloudId,orgId:e.orgId,workspaceId:e.workspaceId};return(0,a("jLhkN").stargateFetchRetryOn5xx)(`${e.stargateUrl}${S.expand({messageId:e.messageId})}`,{method:"post",body:JSON.stringify(t),headers:{"Content-Type":"application/json"}}).then(a("jLhkN").pullResponseTextIfNotOk).then(()=>Promise.resolve())}}),n("kkBs4",function(t,s){e(t.exports,"EngagekitChoreographerPlugin",()=>r);class r extends a("lgeyF").ChoreographerPlugin{constructor(e,t={}){super(a("9ibfU").ProductIds.ENGAGEKIT,e,t)}isValidDuplicateStartRequest(e){let t=(0,a("3ZJPl").Choreographer).getInstance().getCurrentMessage()??(0,a("3ZJPl").Choreographer).getInstance().getCurrentPendingMessage();return!!(t&&t.productId===this.state.productId&&t.messageId===e&&Date.now()-t.timestamp<3e5)}async startMessageWithPlugin(e,t,s={}){let r=new(a("6zoi5")).DebugLogger(this.state.productId,e),i=a("9ibfU").MessageAction.START;r.trace({verbose:"EngagekitChoreographerPlugin::startMessageWithPlugin"});let n=this.isValidDuplicateStartRequest(e);if(n){let n=new(a("e4JSs")).Logger(i,e,{...this.state.metaMetricsData,...s},this.analyticsClient),o=!!await t();return o&&(n.started(),r.log({verbose:{phase:i,plugin:this.constructor.name,disposition:a("9ibfU").MessageDeliveryStatus.STARTED,timestamp:performance.now()}})),o}this.onStart(e,t);let o=await this.startMessage(e,s);return o===a("9ibfU").MessageDeliveryStatus.STARTED}async stopMessageWithPlugin(e,t,s={}){let r=new(a("6zoi5")).DebugLogger(this.state.productId,e);r.trace({verbose:"EngagekitChoreographerPlugin::stopMessageWithPlugin"}),this.onStop(e,t);let i=await this.stopMessage(e,s);return i===a("9ibfU").MessageDeliveryStatus.STOPPED}}}),n("3ZJPl",function(t,s){let r;e(t.exports,"Choreographer",()=>i);class i{static getInstance(){return r||(r=new this),r}constructor(){this.state={currentMessage:null,isDisabled:!1,messages:new Map,messageQueue:[],messageTtl:null,plugins:new Map,queueingBehindMessage:null,shouldQueueMessages:!1}}stopCurrentMessage(){this.state.currentMessage&&this.stopMessageInternal(this.state.currentMessage.productId,this.state.currentMessage.messageId,this.state.currentMessage.analyticsClient,this.state.currentMessage.metricsData,!0).then(()=>{this.clearMessageTtl(),this.enablePlugins()})}queueMessages(e,t){this.state.shouldQueueMessages=!0,this.state.queueingBehindMessage={productId:e,messageId:t,timestamp:Date.now()}}queueMessage(e,t,s,r,i){return new Promise(a=>{this.state.messageQueue.push({productId:e,messageId:t,analyticsClient:s,metricsData:r,plugin:i,resolve:a})})}processQueuedMessage(){let e=this.state.messageQueue.shift();this.state.shouldQueueMessages=!1,this.state.queueingBehindMessage=null,e&&e.resolve(this.startMessage(e.productId,e.messageId,e.analyticsClient,e.metricsData,e.plugin))}destroyMessageQueue(){for(this.state.shouldQueueMessages=!1,this.state.queueingBehindMessage=null;this.state.messageQueue.length>0;){let{analyticsClient:e,messageId:t,metricsData:s,productId:r,resolve:i}=this.state.messageQueue.shift(),n={...s,productId:r,messageId:t},o=a("9ibfU").MessageAction.START,l=new(a("e4JSs")).Logger(o,t,n,e),c=new(a("6zoi5")).DebugLogger(r,t);l.blocked({blockedByProductId:this.state.currentMessage?.productId,blockedByMessageId:this.state.currentMessage?.messageId}),c.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.BLOCKED,blockedByProductId:this.state.currentMessage?.productId,blockedByMessageId:this.state.currentMessage?.messageId}}),i(a("9ibfU").MessageDeliveryStatus.BLOCKED)}}setMessageTtl(e,t,s,r){this.state.currentMessage={productId:e,messageId:t,analyticsClient:s,metricsData:r,timestamp:Date.now()},this.state.messageTtl=setTimeout(()=>{this.isCurrentMessage(e,t)&&this.stopCurrentMessage()},3e5)}isCurrentMessage(e,t){return!!(this.state.currentMessage&&this.state.currentMessage.productId===e&&this.state.currentMessage.messageId===t)}getCurrentMessage(){return this.state.currentMessage}getCurrentPendingMessage(){return this.state.queueingBehindMessage}clearMessageTtl(){this.state.currentMessage=null,this.state.messageTtl&&clearTimeout(this.state.messageTtl)}disablePlugins(e){this.state.isDisabled=!0,[...this.state.plugins.values()].forEach(t=>{t!==e&&t.disable()})}enablePlugins(){[...this.state.plugins.values()].forEach(e=>e.enable()),this.state.isDisabled=!1}unregisterPlugin(e){this.state.currentMessage?.productId===e&&this.stopCurrentMessage(),this.state.messages.delete(e),this.state.plugins.delete(e)}isDisplayingMessage(){return!!(this.state.currentMessage||[...this.state.plugins.values()].reduce((e,t)=>e||t.isDisplayingMessage(),!1))}getMessages(e){return this.state.messages.get(e)??new Map}async startMessage(e,t,s,r={},i){let n=new(a("6zoi5")).DebugLogger(e,t),o=a("9ibfU").MessageAction.START,l=performance.now();n.log({info:{phase:o,timestamp:l},verbose:{phase:o,timestamp:l}});let c={...r,productId:e,messageId:t},u=new(a("e4JSs")).Logger(o,t,c,s);try{if(!this.hasMessageRecord(e,t))return u.unregistered(),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.UNREGISTERED}}),a("9ibfU").MessageDeliveryStatus.UNREGISTERED;if(this.state.shouldQueueMessages)return n.log({verbose:{phase:o,disposition:`queued behind ${this.state.queueingBehindMessage?.productId} ${this.state.queueingBehindMessage?.messageId}`}}),this.queueMessage(e,t,s,r,i);if(this.state.isDisabled||this.isDisplayingMessage())return u.blocked({blockedByProductId:this.state.currentMessage?.productId,blockedByMessageId:this.state.currentMessage?.messageId}),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.BLOCKED,blockedByProductId:this.state.currentMessage?.productId,blockedByMessageId:this.state.currentMessage?.messageId}}),a("9ibfU").MessageDeliveryStatus.BLOCKED;let l=this.ensureMessageRecord(e,t);this.queueMessages(e,t);let c=await l.start?.()??!0;if(c)return l.onStart?.(),u.started(),this.disablePlugins(i),this.setMessageTtl(e,t,s,r),this.destroyMessageQueue(),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.STARTED}}),a("9ibfU").MessageDeliveryStatus.STARTED;return this.processQueuedMessage(),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.CANCELED}}),a("9ibfU").MessageDeliveryStatus.CANCELED}catch(e){return u.error({reason:e.message}),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.ERROR}}),a("9ibfU").MessageDeliveryStatus.ERROR}}async stopMessageInternal(e,t,s,r={},i=!1){let n=new(a("6zoi5")).DebugLogger(e,t),o=a("9ibfU").MessageAction.STOP,l=performance.now();n.log({info:{phase:o,timestamp:l},verbose:{phase:o,timestamp:l}});let c={...r,productId:e,messageId:t},u=new(a("e4JSs")).Logger(o,t,c,s);try{if(!this.hasMessageRecord(e,t))return u.unregistered(),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.UNREGISTERED}}),a("9ibfU").MessageDeliveryStatus.UNREGISTERED;let s=this.ensureMessageRecord(e,t);this.isCurrentMessage(e,t)&&this.queueMessages(e,t);let r=await s.stop?.()??!0;if(r||i)return this.isCurrentMessage(e,t)&&(s.onStop?.(),u.stopped(i?{forceStop:i,didStop:r}:void 0),this.clearMessageTtl(),this.enablePlugins()),this.processQueuedMessage(),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.STOPPED}}),a("9ibfU").MessageDeliveryStatus.STOPPED;return this.destroyMessageQueue(),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.CANCELED}}),a("9ibfU").MessageDeliveryStatus.CANCELED}catch(e){return u.error({reason:e.message}),n.log({verbose:{phase:o,disposition:a("9ibfU").MessageDeliveryStatus.ERROR}}),a("9ibfU").MessageDeliveryStatus.ERROR}}async stopMessage(e,t,s,r={}){return this.stopMessageInternal(e,t,s,r)}registerPlugin(e,t){if(this.state.plugins.has(e))throw Error(`Choreographer plugin already registered for ${e}!`);return this.state.plugins=this.state.plugins.set(e,t),this.state.isDisabled&&t.disable(),()=>{this.unregisterPlugin(e)}}ensureMessageRecord(e,t){let s=this.state.messages.get(e);s||(s=new Map,this.state.messages.set(e,s));let r=s.get(t);return r||(r={},s.set(t,r)),r}hasMessageRecord(e,t){return!!this.state.messages.get(e)?.has?.(t)}on(e,t,s={},r={}){let i={...this.ensureMessageRecord(e,t),...s,...r};this.state.messages.get(e).set(t,i)}onStart(e,t,s,r){this.on(e,t,{start:s},r)}onStop(e,t,s,r={}){this.on(e,t,{stop:s},r)}off(e,t){this.state.messages.get(e)?.delete?.(t)}}}),n("9ibfU",function(t,s){var r,i;e(t.exports,"MessageEventType",()=>a),e(t.exports,"MessageDeliveryStatus",()=>n),e(t.exports,"ProductIds",()=>r),e(t.exports,"IntegratedChoreographerMessageTypesEnum",()=>o),e(t.exports,"MessageAction",()=>l);let a={START:"start",STOP:"stop"},n={BLOCKED:"blocked",CANCELED:"canceled",ERROR:"error",STARTED:"started",STOPPED:"stopped",UNREGISTERED:"unregistered"};(i=r||(r={})).CONFLUENCE="confluence",i.ENGAGEKIT="Engagekit",i.INTERCOM="intercom",i.JIRA="jira",i.PENDO="pendo",i.CLOUDADMIN="cloudadmin",i.BITBUCKET="bitbucket",i.POST_OFFICE="post-office";let o=["engagement","marketing"],l={START:"messageStart",STOP:"messageStop"}}),n("6zoi5",function(t,s){function r(){return window.choreographerLoggingLevel}e(t.exports,"DebugLogger",()=>i);class i{constructor(e,t){this.log=e=>{[...Object.keys(e)].forEach(t=>{var s;s={productId:this.state.productId,messageId:this.state.messageId,...e[t]??{},..."verbose"===t?{timestamp:performance.now()}:{}},r()===t&&console.table(s)})},this.trace=e=>{[...Object.keys(e)].forEach(t=>{var s,i,a;s=this.state.productId,i=this.state.messageId,a=`${e[t]}${"verbose"===t?` (${performance.now()})`:""}`,r()===t&&console.log(`CHOREOGRAPHER - ${s} - ${i} - ${a}`)})},this.state={productId:e,messageId:t}}}}),n("e4JSs",function(t,s){e(t.exports,"Logger",()=>r);class r{constructor(e,t,s,r){this.state={actionSubject:e,actionSubjectId:t,metricsData:s,analyticsClient:r}}sendOperationalEvent(e,t){if((0,a("b2t3Q").fg)("platform.post-office.enable-full-choreographer-logging")){let{analyticsClient:s,actionSubject:r,actionSubjectId:i,metricsData:a}=this.state;s.sendOperationalEvent({source:"choreographer",action:e,actionSubject:r,actionSubjectId:i,attributes:{...a??{},...t??{}},tags:["postOffice"]})}}blocked(e){this.sendOperationalEvent(a("9ibfU").MessageDeliveryStatus.BLOCKED,e)}error(e){this.sendOperationalEvent(a("9ibfU").MessageDeliveryStatus.ERROR,e)}unregistered(e){this.sendOperationalEvent(a("9ibfU").MessageDeliveryStatus.UNREGISTERED,e)}started(e){this.sendOperationalEvent(a("9ibfU").MessageDeliveryStatus.STARTED,e)}stopped(e){this.sendOperationalEvent(a("9ibfU").MessageDeliveryStatus.STOPPED,e)}}}),n("lgeyF",function(t,s){e(t.exports,"ChoreographerPlugin",()=>r);class r{constructor(e,t,s={}){this.state={isDisabled:!1,isDisplayingMessage:!1,metaMetricsData:s,productId:e,unregisterPlugin:()=>{}},this.analyticsClient=this.createAnalyticsClient(t),this.finalizers={onStart:()=>this.blockDisplayState(),onStop:()=>this.clearDisplayState()},this.state.unregisterPlugin=this.registerPlugin(e)}destroy(){this.state.unregisterPlugin()}isDisplayingMessage(){return this.state.isDisplayingMessage}blockDisplayState(){this.state.isDisplayingMessage=!0}clearDisplayState(){this.state.isDisplayingMessage=!1}disable(){this.state.isDisabled=!0}enable(){this.state.isDisabled=!1}async startMessage(e,t={}){return(0,a("3ZJPl").Choreographer).getInstance().startMessage(this.state.productId,e,this.analyticsClient,{...this.state.metaMetricsData,...t},this)}async stopMessage(e,t={}){return(0,a("3ZJPl").Choreographer).getInstance().stopMessage(this.state.productId,e,this.analyticsClient,{...this.state.metaMetricsData,...t})}on(e,t={}){return(0,a("3ZJPl").Choreographer).getInstance().on(this.state.productId,e,t,this.finalizers)}onStart(e,t){return(0,a("3ZJPl").Choreographer).getInstance().onStart(this.state.productId,e,t,this.finalizers)}onStop(e,t){return(0,a("3ZJPl").Choreographer).getInstance().onStop(this.state.productId,e,t,this.finalizers)}off(e){return(0,a("3ZJPl").Choreographer).getInstance().off(this.state.productId,e)}registerPlugin(e){return(0,a("3ZJPl").Choreographer).getInstance().registerPlugin(e,this)}createAnalyticsClient(e){let t=new(a("4si91")).default({env:e,product:"postOffice",origin:a("9Q7Jj").originType.WEB});return t}}});const d=204;n("jLhkN",function(t,s){async function r(e){if(!e.ok)throw Error(`${e.status}: ${await e.text()}`);return e}async function i(e){return e.ok||await e.text(),e}function n(e){let t=e.headers.get("X-Failure-Category"),s=!!t&&"throttled"===t.toLowerCase();return 503===e.status&&s}function o(e,t,s=n){var r;return r={...t,credentials:(0,a("1r0b0").default).includes(location.host)?"include":"same-origin"},c(fetch(e,r),s,()=>(function e(t,s,r,i=0){return c(function(e,t,s){let r=t?6e4*t+Math.round(5e3*Math.random()):0;return new Promise((t,i)=>{setTimeout(()=>{fetch(e,s).then(t).catch(i)},r)})}(t,i,r),s,()=>e(t,s,r,Math.min(0===i?1:2*i,60)))})(e,s,r))}function l(e,t){return o(e,t,e=>e.status>=500&&e.status<=599)}function c(e,t,s){return e.then(e=>t(e)?s():Promise.resolve(e)).catch(s)}e(t.exports,"errorIfNotOk",()=>r),e(t.exports,"pullResponseTextIfNotOk",()=>i),e(t.exports,"stargateFetch",()=>o),e(t.exports,"stargateFetchRetryOn5xx",()=>l)}),n("1r0b0",function(t,s){e(t.exports,"default",()=>r);var r=["bitbucket-pipelines.dev.public.atl-paas.net","bitbucket-pipelines.staging.public.atl-paas.net","bitbucket-pipelines.prod.public.atl-paas.net"]}),n("3xGTJ",function(s,r){e(s.exports,"EngagementProvider",()=>h);var i=a("eUqFw"),n=a("046kq"),o=a("6l6Xk"),l=a("1Zvbf");function c(e,t){let s=new(a("15Xui")).default({payload:{action:"exposed",actionSubject:"feature",actionSubjectId:e.flagKey,source:"engagement-platform",attributes:e}});Promise.resolve(t).then(e=>{e.sendTrackEvent(s.payload)})}function u(e,t,s){return{reason:"RULE_MATCH",ruleId:"engagement.inproduct",flagKey:`engagement.inproduct.${e}`,value:t,...s}}async function d(e,t,s,r,i,n){let{locale:o}=t,{message:l,component:d}=e;if(l.holdout){await (0,a("3Li4R").startMessage)({cloudId:t.cloudId,stargateUrl:t.stargateUrl,messageId:l.messageId,variationId:l.variationId,orgId:t.orgId,workspaceId:t.workspaceId},i),await (0,a("3Li4R").stopMessage)({cloudId:t.cloudId,stargateUrl:t.stargateUrl,messageId:l.messageId,orgId:t.orgId,workspaceId:t.workspaceId},i),c(u(l.messageId,"holdout",{locale:o}),r);return}if(0===d.componentId){let d=await (0,a("3Li4R").startMessage)({cloudId:t.cloudId,stargateUrl:t.stargateUrl,messageId:l.messageId,variationId:l.variationId,orgId:t.orgId,workspaceId:t.workspaceId},i);i?.enableChoreographer&&n?.onMessageDisposition&&n.onMessageDisposition(d?a("9ibfU").MessageDeliveryStatus.STARTED:a("9ibfU").MessageDeliveryStatus.BLOCKED),d&&(c(u(l.messageId,l.variationId,{locale:o}),r),s.dispatch((0,a("1B2U3").setCurrent)(e)))}else c(u(l.messageId,l.variationId,{locale:o}),r),s.dispatch((0,a("1B2U3").setCurrent)(e))}class h extends i.Component{static{this.childContextTypes={subscribeEngagementState:t(a("1Qivz")).func,setComponentConfig:t(a("1Qivz")).func}}static{this.defaultProps={eventTarget:t(l)}}static{this.hasInitializedAtLeastOneEngagementProvider=!1}constructor(e){super(e),this.onStoreChange=e=>{let{createAnalyticsEvent:t}=this.props,s=this.getConfig(),{locale:r}=s;if(e.initialized){if(!h.hasInitializedAtLeastOneEngagementProvider){this.sendOperationalEventWithClient({action:"loaded",actionSubject:"messages",actionSubjectId:void 0,source:"engagekit",attributes:{locale:r}});let e=(0,a("6NqI7").getBrowserInfo)();this.onEvent(t({event:"engagement.inproduct.loaded",properties:{browser:e.name,browserVersion:e.version}})),h.hasInitializedAtLeastOneEngagementProvider=!0}this.analyticsEventQueue.flush(this.onEvent),this.unsubscribeFromStore&&this.unsubscribeFromStore()}},this.onEvent=e=>{let s;let r=this.getState();if(!r.initialized){let t=this.analyticsEventQueue.enqueue(e);t||this.fireQueueOverflowEvent();return}let{eventTarget:i,store:o,analyticsClientInstance:l}=this.props,c=this.getConfig(),{current:u,messageMapping:h}=r,p=function(e){let t={...e.payload,context:{}};return Object.assign(t.context,...e.context),t}(e);if(i.dispatchEvent((0,a("al1GJ").default)({eventName:"ep.analyticEvent",canBubble:!1,cancellable:!1,detail:p})),!(0,a("1XdiR").isMessagingEnabled)()||u)return;let g=Array.from(h.keys()).find(e=>t(n)(p,e));if(!g)return;let m=h.get(g);if(m.component?.componentType){let e=this.getConfigId(m.component.componentType,m.component.target);s=this.componentConfig.get(e)}let f=this.getComponentCoordinationOptions(s);d(m,c,o,l,f,s)},this.onEngagementEvent=e=>{let{action:t,clickType:s,ekMessageId:r,ekVariationId:i,ekComponentId:a,ekComponentType:n,ekIsLast:o}=e.payload,l=this.getConfig(),{locale:c}=l,u={messageId:r,variationId:i,componentIndex:a,locale:c};"click"===t?(this.handleClickEvent(r,i,a),u.buttonType=s,this.sendUIEventWithClient({action:"clicked",actionSubject:"button",actionSubjectId:`${s}Button`,source:`engagement_${n}`,attributes:u})):("shown"===t&&(u.componentType=n,this.sendScreenEventWithClient({name:`engagement_${n}`,attributes:u})),"hidden"===t&&(u.isLast=o,this.sendUIEventWithClient({action:"hid",actionSubject:"component",actionSubjectId:void 0,source:`engagement_${n}`,attributes:u}))),this.onEvent(e)},this.subscribeEngagementState=e=>{let{store:t}=this.props;return e(t.getState()),t.subscribe(()=>{e(t.getState())})},this.getComponentCoordinationOptions=e=>{let t=!!this.props.coordinationOptions?.enableChoreographer;return{...this.props.coordinationOptions,enableChoreographer:e?.messageType?(0,a("iUAhx").shouldBeChoreographed)(e,{enableChoreographer:!0}):t}},this.getConfigId=(e,t)=>t?`${e}-${t}`:e,this.setComponentConfig=(e,t,s)=>{let r=this.getConfigId(e,s);return this.componentConfig.set(r,t),()=>this.removeComponentConfig(r)},this.removeComponentConfig=e=>{this.componentConfig.has(e)&&this.componentConfig.delete(e)};let{analyticsClientInstance:s}=this.props;this.sendUIEventWithClient=(0,a("gYcOl").sendUIEvent).bind(null,s),this.sendScreenEventWithClient=(0,a("gYcOl").sendScreenEvent).bind(null,s),this.sendOperationalEventWithClient=(0,a("gYcOl").sendOperationalEvent).bind(null,s),this.analyticsEventQueue=new(a("dppSb")).default(100),this.unsubscribeFromStore=this.subscribeEngagementState(this.onStoreChange),this.fireQueueOverflowEvent=t(o)(()=>{}),this.componentConfig=new Map}getConfig(){let{config:e}=this.getState();return e}getChildContext(){return{subscribeEngagementState:this.subscribeEngagementState,setComponentConfig:this.setComponentConfig}}getState(){return this.props.store.getState()}getActiveMessage(){return this.getState().current}async completeMessage(e,t){let s=this.getConfig(),r=this.getComponentCoordinationOptions(t),i=await (0,a("3Li4R").stopMessage)({cloudId:s.cloudId,stargateUrl:s.stargateUrl,messageId:e,orgId:s.orgId,workspaceId:s.workspaceId},r);r.enableChoreographer&&t?.onMessageDisposition&&t.onMessageDisposition(i?a("9ibfU").MessageDeliveryStatus.STOPPED:a("9ibfU").MessageDeliveryStatus.CANCELED)}handleClickEvent(e,t,s){let r;let i=this.getActiveMessage();if(i&&i.messageId===e&&i.variationId===t&&i.componentId===s){if(i.componentType){let e=this.getConfigId(i.componentType,i.target);r=this.componentConfig.get(e)}i.isLast&&this.completeMessage(e,r),this.props.store.dispatch((0,a("1B2U3").clearCurrent)())}}componentWillUnmount(){this.unsubscribeFromStore&&this.unsubscribeFromStore()}render(){return t(i).createElement(a("iR3oh").default,{channel:"*",onEvent:this.onEvent},t(i).createElement(a("iR3oh").default,{channel:"engagement",onEvent:this.onEngagementEvent},this.props.children))}}}),n("iUAhx",function(s,r){e(s.exports,"shouldBeChoreographed",()=>n),e(s.exports,"wrapComponentForChoreographer",()=>o),e(s.exports,"wrapToggleableComponentForChoreographer",()=>l);var i=a("eUqFw");let n=(e,t)=>!!t?.enableChoreographer&&e?.messageType!==void 0&&(0,a("9ibfU").IntegratedChoreographerMessageTypesEnum).includes(e.messageType),o=e=>{function s({shouldBeChoreographed:s,withChoreographedRender:r,...a}){let n=(0,i.useMemo)(()=>r(e),[r]);if(s(a)){let{messageType:e,...s}=a;return t(i).createElement(n,s)}let{messageType:o,messageId:l,onMessageDisposition:c,...u}=a;return t(i).createElement(e,u)}return s.displayName=`ChoreographerWrapped${(e.displayName??e.name)||"Component"}`,s},l=(e,s)=>{function r({shouldBeChoreographed:r,withChoreographedToggle:a,...n}){let o=(0,i.useMemo)(()=>a(e,s),[a]);if(r(n)){let{messageType:e,...s}=n;return t(i).createElement(o,s)}let{messageType:l,messageId:c,onMessageDisposition:u,...d}=n;return t(i).createElement(e,d)}return r.displayName=`ChoreographerWrapped${(e.displayName??e.name)||"Component"}`,r}}),n("gYcOl",function(t,s){function r(e,t){Promise.resolve(e).then(e=>{e.sendScreenEvent(t)})}function i(e,t){Promise.resolve(e).then(e=>{e.sendUIEvent(t)})}function a(e,t){Promise.resolve(e).then(e=>{e.sendOperationalEvent(t)})}e(t.exports,"sendScreenEvent",()=>r),e(t.exports,"sendUIEvent",()=>i),e(t.exports,"sendOperationalEvent",()=>a)}),n("6NqI7",function(t,s){e(t.exports,"getBrowserInfo",()=>a);let r=[{name:"IE",pattern:/Trident\/.*; rv:([^;)]+)/},{name:"Chrome",pattern:/Chrome\/([^ )]+)/},{name:"Firefox",pattern:/Firefox\/([^ )]+)/}],i={name:"unknown",version:"unknown"};function a(e){if(!window.navigator)return i;for(let t of(e||(e=window.navigator.userAgent),r)){let s=e.match(t.pattern);if(s)return{name:t.name,version:s[1]}}return i}}),n("al1GJ",function(t,s){e(t.exports,"default",()=>r);var r=({eventName:e,canBubble:t,cancellable:s,detail:r})=>{let i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t,s,r),i}}),n("dppSb",function(t,s){e(t.exports,"default",()=>r);class r{constructor(e){this.queue=[],this.maxSize=e}enqueue(e){return this.queue.length!==this.maxSize&&(this.queue.push(e),!0)}flush(e){this.queue.forEach(e),this.queue=[]}getSize(){return this.queue.length}}}),n("ad8sn",function(t,s){e(t.exports,"default",()=>n);var r=a("cJt2B");let i={initialPollInterval:5e3,idleTimeout:3e4,multiplierCallback:e=>e+e};class n{constructor(e,t,s,n){if(this.start=()=>{this.browserInteractionTime.startTimer(),this.browserInteractionTime.addTimeIntervalEllapsedCallback({callback:e=>this._sendDwellEvent(this._eventData,this._searchSessionId,e,!1),timeInMilliseconds:this._timing.initialPollInterval,multiplier:this._timing.multiplierCallback}),"undefined"!=typeof window&&window.addEventListener("beforeunload",this._onBeforeUnload)},this.stop=()=>{this.browserInteractionTime.isRunning()&&this._sendDwellEvent(this._eventData,this._searchSessionId,this.browserInteractionTime.getTimeInMilliseconds(),!0),this.browserInteractionTime.stopTimer()},this.newPage=(e,t)=>{(0,a("6cTjW").validateDwellBaseEvent)(e),this.stop(),this.browserInteractionTime.reset(),this.setEventData(e),this.setSearchSessionId(t),this.start()},this.setEventData=e=>{this._eventData=e},this.getEventData=()=>this._eventData,this.setSearchSessionId=e=>{this._searchSessionId=e},this.getSearchSessionId=()=>this._searchSessionId,this.destroy=()=>{this.browserInteractionTime.destroy(),"undefined"!=typeof window&&window.removeEventListener("beforeunload",this._onBeforeUnload)},this._onBeforeUnload=()=>{this.stop(),this.destroy()},this._sendDwellEvent=(e,t,s,r)=>{this._trackCallback({action:"dwelled",actionSubject:e.actionSubject,actionSubjectId:e.actionSubjectId,source:e.source,containerType:e.containerType,containerId:e.containerId,objectType:e.objectType,objectId:e.objectId,attributes:{dwellTime:s,searchReferrer:t,finalDwellEvent:r,...e.attributes},tags:e.tags})},!e)throw Error("trackCallback is required for DwellTimeHelper");(0,a("6cTjW").validateDwellBaseEvent)(t),this._trackCallback=e,this._eventData=t,this._searchSessionId=s,this._timing={...i,...n},this.browserInteractionTime=new r.default({idleTimeoutMs:this._timing.idleTimeout,checkCallbacksIntervalMs:500})}}}),n("4uR98",function(s,r){e(s.exports,"default",()=>o);var i=a("6rgVQ");let n={initialPollInterval:5,pollBackoffRate:2,idleTimeout:30};class o{constructor(e,s,r,o,l){if(this.timeMeInitialized=!1,this.start=()=>{if(this.timeMeInitialized)throw Error("DwellTimeHelper should only be initialised once per page load.");this.timeMeInitialized=!0,this._initDwellTimeCounterAndPolling(),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{this.stop()})},this.stop=()=>{t(i).isUserCurrentlyOnPage&&this._sendDwellEvent(this._eventData,this._searchSessionId,!0),t(i).stopAllTimers(),t(i).resetAllRecordedPageTimes(),t(i).timeElapsedCallbacks=[],this.timeMeInitialized=!1},this.newPage=(e,t)=>{(0,a("6cTjW").validateDwellBaseEvent)(e),this.stop(),this._eventData=e,this._searchSessionId=t,this._initDwellTimeCounterAndPolling()},this._listForIdleEvents=()=>{document.addEventListener("mousemove",()=>{t(i).userActivityDetected()}),document.addEventListener("keyup",()=>{t(i).userActivityDetected()}),document.addEventListener("touchstart",()=>{t(i).userActivityDetected()}),window.addEventListener("scroll",()=>{t(i).userActivityDetected()});let e=document.getElementsByTagName("iframe");for(let s=0;s<e.length;s++){let r=e[s];try{r?.contentWindow?.document.addEventListener("mousemove",()=>{t(i).userActivityDetected()}),r?.contentWindow?.document.addEventListener("keyup",()=>{t(i).userActivityDetected()}),r?.contentWindow?.document.addEventListener("touchstart",()=>{t(i).userActivityDetected()})}catch(e){}}setInterval(()=>{!0!==t(i).isUserCurrentlyIdle&&(t(i).checkIdleState(),t(i).startTimer())},t(i).checkIdleStateRateMs)},this._initDwellTimeCounterAndPolling=()=>{this._dwellTimeHelperOptions?.iframeDwell&&(t(i).listForIdleEvents=this._listForIdleEvents),t(i).initialize({idleTimeoutInSeconds:this._timing.idleTimeout}),this._pollDwellTime(this._timing.initialPollInterval,this._searchSessionId,this._eventData)},this._pollDwellTime=(e,s,r)=>{t(i).callAfterTimeElapsedInSeconds(e,()=>{this._sendDwellEvent(r,s,!1),this._pollDwellTime(e*this._timing.pollBackoffRate,s,r)})},this._sendDwellEvent=(e,s,r)=>{let a={dwellTime:t(i).getTimeOnCurrentPageInMilliseconds(),searchReferrer:s,finalDwellEvent:r};this._trackCallback({action:"dwelled",actionSubject:e.actionSubject,actionSubjectId:e.actionSubjectId,source:e.source,containerType:e.containerType,containerId:e.containerId,containers:e.containers,objectType:e.objectType,objectId:e.objectId,attributes:{...a,...e.attributes},tags:e.tags})},!e)throw Error("trackCallback is required for DwellTimeHelper");(0,a("6cTjW").validateDwellBaseEvent)(s),this._trackCallback=e,this._eventData=s,this._searchSessionId=r,this._timing={...n,...o},this._dwellTimeHelperOptions=l}}});var h={};e(h,"R50",()=>p),e(h,"R75",()=>g),e(h,"R100",()=>m),e(h,"R200",()=>f),e(h,"R300",()=>y),e(h,"R400",()=>E),e(h,"R500",()=>v),e(h,"Y50",()=>I),e(h,"Y75",()=>b),e(h,"Y100",()=>T),e(h,"Y200",()=>w),e(h,"Y300",()=>S),e(h,"Y400",()=>A),e(h,"Y500",()=>_),e(h,"G50",()=>C),e(h,"G75",()=>x),e(h,"G100",()=>k),e(h,"G200",()=>O),e(h,"G300",()=>D),e(h,"G400",()=>N),e(h,"G500",()=>R),e(h,"B50",()=>M),e(h,"B75",()=>P),e(h,"B100",()=>F),e(h,"B200",()=>L),e(h,"B300",()=>U),e(h,"B400",()=>j),e(h,"B500",()=>B),e(h,"P50",()=>K),e(h,"P75",()=>J),e(h,"P100",()=>Q),e(h,"P200",()=>G),e(h,"P300",()=>V),e(h,"P400",()=>W),e(h,"P500",()=>$),e(h,"T50",()=>q),e(h,"T75",()=>H),e(h,"T100",()=>X),e(h,"T200",()=>z),e(h,"T300",()=>Y),e(h,"T400",()=>Z),e(h,"T500",()=>ee),e(h,"N0",()=>et),e(h,"N10",()=>es),e(h,"N20",()=>er),e(h,"N30",()=>ei),e(h,"N40",()=>ea),e(h,"N50",()=>en),e(h,"N60",()=>eo),e(h,"N70",()=>el),e(h,"N80",()=>ec),e(h,"N90",()=>eu),e(h,"N100",()=>ed),e(h,"N200",()=>eh),e(h,"N300",()=>ep),e(h,"N400",()=>eg),e(h,"N500",()=>em),e(h,"N600",()=>ef),e(h,"N700",()=>ey),e(h,"N800",()=>eE),e(h,"N900",()=>ev),e(h,"N10A",()=>eI),e(h,"N20A",()=>eb),e(h,"N30A",()=>eT),e(h,"N40A",()=>ew),e(h,"N50A",()=>eS),e(h,"N60A",()=>eA),e(h,"N70A",()=>e_),e(h,"N80A",()=>eC),e(h,"N90A",()=>ex),e(h,"N100A",()=>ek),e(h,"N200A",()=>eO),e(h,"N300A",()=>eD),e(h,"N400A",()=>eN),e(h,"N500A",()=>eR),e(h,"N600A",()=>eM),e(h,"N700A",()=>eP),e(h,"N800A",()=>eF),e(h,"DN900",()=>eL),e(h,"DN800",()=>eU),e(h,"DN700",()=>ej),e(h,"DN600",()=>eB),e(h,"DN500",()=>eK),e(h,"DN400",()=>eJ),e(h,"DN300",()=>eQ),e(h,"DN200",()=>eG),e(h,"DN100",()=>eV),e(h,"DN90",()=>eW),e(h,"DN80",()=>e$),e(h,"DN70",()=>eq),e(h,"DN60",()=>eH),e(h,"DN50",()=>eX),e(h,"DN40",()=>ez),e(h,"DN30",()=>eY),e(h,"DN20",()=>eZ),e(h,"DN10",()=>e0),e(h,"DN0",()=>e1),e(h,"DN800A",()=>e9),e(h,"DN700A",()=>e3),e(h,"DN600A",()=>e7),e(h,"DN500A",()=>e2),e(h,"DN400A",()=>e6),e(h,"DN300A",()=>e5),e(h,"DN200A",()=>e4),e(h,"DN100A",()=>e8),e(h,"DN90A",()=>te),e(h,"DN80A",()=>tt),e(h,"DN70A",()=>ts),e(h,"DN60A",()=>tr),e(h,"DN50A",()=>ti),e(h,"DN40A",()=>ta),e(h,"DN30A",()=>tn),e(h,"DN20A",()=>to),e(h,"DN10A",()=>tl);const p="#FFEBE6",g="#FFBDAD",m="#FF8F73",f="#FF7452",y="#FF5630",E="#DE350B",v="#BF2600",I="#FFFAE6",b="#FFF0B3",T="#FFE380",w="#FFC400",S="#FFAB00",A="#FF991F",_="#FF8B00",C="#E3FCEF",x="#ABF5D1",k="#79F2C0",O="#57D9A3",D="#36B37E",N="#00875A",R="#006644",M="#DEEBFF",P="#B3D4FF",F="#4C9AFF",L="#2684FF",U="#0065FF",j="#0052CC",B="#0747A6",K="#EAE6FF",J="#C0B6F2",Q="#998DD9",G="#8777D9",V="#6554C0",W="#5243AA",$="#403294",q="#E6FCFF",H="#B3F5FF",X="#79E2F2",z="#00C7E6",Y="#00B8D9",Z="#00A3BF",ee="#008DA6",et="#FFFFFF",es="#FAFBFC",er="#F4F5F7",ei="#EBECF0",ea="#DFE1E6",en="#C1C7D0",eo="#B3BAC5",el="#A5ADBA",ec="#97A0AF",eu="#8993A4",ed="#7A869A",eh="#6B778C",ep="#5E6C84",eg="#505F79",em="#42526E",ef="#344563",ey="#253858",eE="#172B4D",ev="#091E42",eI="rgba(9, 30, 66, 0.02)",eb="rgba(9, 30, 66, 0.04)",eT="rgba(9, 30, 66, 0.08)",ew="rgba(9, 30, 66, 0.13)",eS="rgba(9, 30, 66, 0.25)",eA="rgba(9, 30, 66, 0.31)",e_="rgba(9, 30, 66, 0.36)",eC="rgba(9, 30, 66, 0.42)",ex="rgba(9, 30, 66, 0.48)",ek="rgba(9, 30, 66, 0.54)",eO="rgba(9, 30, 66, 0.60)",eD="rgba(9, 30, 66, 0.66)",eN="rgba(9, 30, 66, 0.71)",eR="rgba(9, 30, 66, 0.77)",eM="rgba(9, 30, 66, 0.82)",eP="rgba(9, 30, 66, 0.89)",eF="rgba(9, 30, 66, 0.95)",eL="#E6EDFA",eU="#DCE5F5",ej="#CED9EB",eB="#B8C7E0",eK="#ABBBD6",eJ="#9FB0CC",eQ="#8C9CB8",eG="#7988A3",eV="#67758F",eW="#56637A",e$="#455166",eq="#3B475C",eH="#313D52",eX="#283447",ez="#202B3D",eY="#1B2638",eZ="#121A29",e0="#0E1624",e1="#0D1424",e9="rgba(13, 20, 36, 0.06)",e3="rgba(13, 20, 36, 0.14)",e7="rgba(13, 20, 36, 0.18)",e2="rgba(13, 20, 36, 0.29)",e6="rgba(13, 20, 36, 0.36)",e5="rgba(13, 20, 36, 0.40)",e4="rgba(13, 20, 36, 0.47)",e8="rgba(13, 20, 36, 0.53)",te="rgba(13, 20, 36, 0.63)",tt="rgba(13, 20, 36, 0.73)",ts="rgba(13, 20, 36, 0.78)",tr="rgba(13, 20, 36, 0.81)",ti="rgba(13, 20, 36, 0.85)",ta="rgba(13, 20, 36, 0.89)",tn="rgba(13, 20, 36, 0.92)",to="rgba(13, 20, 36, 0.95)",tl="rgba(13, 20, 36, 0.97)";s.rlb("2Lfdl");try{performance.mark("shared~vendor~atlassian~ar.js:eval-stop")}catch(e){}
//# sourceMappingURL=https://jira-frontend-bifrost.prod-east.frontend.public.atl-paas.net/assets/shared~vendor~atlassian~ar.6cc5f934.js.map
